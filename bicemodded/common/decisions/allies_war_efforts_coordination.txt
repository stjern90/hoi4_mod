coordinate_war_effort = {

	# Decisions for Faction Leaders or Overlords to order their allies / puppets to defend or not defend another allied country
	# In short: Country X can get ordered by the Faction Leader or Overlord to defend or not defend Country Y

	coordinate_war_effort = {
		name = "Coordinate the War Effort"
		icon = generic_operation

		#days_remove = 0
		
		available = { #just a nice and clear tooltip
			if = {
				limit = {
					is_faction_leader = yes
				}
				is_faction_leader = yes 
			}
			else = {
				num_subjects > 0
			}
		}

		visible = {
			has_war = yes 
			NOT = { has_country_flag = coordinate_war_effort }
			OR = {
				is_faction_leader = yes
				num_subjects > 0
			}
		}
		
		complete_effect = {
			set_country_flag = coordinate_war_effort
			
			every_country = {
				limit = {
					OR = {
						is_in_faction_with = ROOT 
						is_subject_of = ROOT 
					}
				}
				ROOT = { 	
					activate_targeted_decision = {
						decision = coordinate_war_effort_@FROM
						target = PREV
					}
				}
			}
				
		}

		ai_will_do = {
			factor = 0
		}
	}
	coordinate_war_effort_@FROM = {
		name = "Coordinate [From.GetAdjective] War Efforts"
		icon = generic_operation

		#days_remove = 0
		
		available = {
			
		}

		visible = {
			has_war = yes
			has_country_flag = coordinate_war_effort
			NOT = { has_country_flag = war_coordination }
			FROM = {
				OR = {
				is_in_faction_with = ROOT 
				is_subject_of = ROOT 
				}
			}
		}

		#target_trigger = {
		#	FROM = {
		#		OR = {
		#			is_in_faction_with = ROOT 
		#			is_subject_of = ROOT 
		#		}
		#	}
		#}
		
		complete_effect = {
			set_country_flag = war_coordination
			FROM = { 
				ROOT = { set_variable = { coordination_target = Prev.id } }
				set_country_flag = war_coordination_target
			}
			every_country = {
				limit = {
					NOT = { tag = FROM }
					OR = {
						is_in_faction_with = ROOT 
						is_subject_of = ROOT 
					}
					#has_war_together_with = FROM
				}
				ROOT = {
					activate_targeted_decision = {
						decision = dont_defend_FROM
						target = PREV
					}
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
	dont_defend_FROM = {
		icon = generic_operation
 
		#days_remove = 0
		
		available = {
			has_war = yes
			has_country_flag = war_coordination
			has_variable = coordination_target
		}

		visible = {
			has_war = yes
			has_country_flag = war_coordination
			has_variable = coordination_target
		}

		complete_effect = {
			var:Root.coordination_target = {
				custom_effect_tooltip = dont_defend_FROM_TT
				set_country_flag = EAI_ignore_borders_@FROM
				clr_country_flag = war_coordination
			}
			clear_variable = coordination_target
			clr_country_flag = war_coordination
			clr_country_flag = coordinate_war_effort
		}
				
	
		ai_will_do = {
			factor = 0
		}
	}
	
	EAI_diplomacy_ignore_borders_DECISION = {
		allowed = {}
    
		available = {

		}
    
		visible = {
			is_ai = no
			
			NOT = { has_country_flag = EAI_ignore_borders_@ROOT }
			
			any_allied_country = { is_ai = yes }
		}
    
		cost = 0
    
		days_re_enable = 0
    
		complete_effect = {
			every_country = {
				set_country_flag = EAI_ignore_borders_@ROOT
				custom_effect_tooltip = dont_defend_ROOT_TT
			}
		}
    
		ai_will_do = {
			factor = 0
		}
	}
}
