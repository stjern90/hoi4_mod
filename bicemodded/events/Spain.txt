###########################
# Spanish Events
###########################

add_namespace = spain

# Spanish Civil War
country_event = {
	id = spain.1
	title = spain.1.t
	desc = spain.1.d
	picture = GFX_report_event_spain_civil_war
	
	is_triggered_only= yes
	
	immediate = {
		hidden_effect = {
			169 = {
				add_building_construction = {
					type = bunker
					level = 3
					province = 7183
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 3
					province = 1178
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 3
					province = 1048
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = 879
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 875
					instant_build = yes
				}	
			}
			174 = {
				add_building_construction = {
					type = bunker
					level = 2
					province = 918
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 4024
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = 726
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = 9699
					instant_build = yes
				}								
			}
			171 = {		
				add_building_construction = {
					type = bunker
					level = 2
					province = 11677
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 3
					province = 11692
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 3
					province = 758
					instant_build = yes
				}	
			}
			173 = {
				add_building_construction = {
					type = bunker
					level = 3
					province = 9979
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 3
					province = 747
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 1192
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 7196
					instant_build = yes
				}						
			}
			168 = {
				add_building_construction = {
					type = bunker
					level = 3
					province = 10024
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = 11807
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = 11884
					instant_build = yes
				}
			}
			176 = {
				add_building_construction = {
					type = bunker
					level = 3
					province = 11825
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 885
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = 884
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 3887
					instant_build = yes
				}	
			}
		}
	}
	
	option = { # Support Nationalists
		name = spain.1.a
		trigger = { is_ai = no  NOT = { has_country_flag = SPR_communist_civil_war } }
		hidden_effect = {
			set_capital = 176
			start_civil_war = {
				ruling_party = fascism
				ideology = communism
				size = 0.5
				capital = 41
				states = { 41 165 167 168 172 173 175 }
			}
			random_country = {
				limit = {
					original_tag = SPR
					has_government = communism
				}
				create_field_marshal = {
					name = "José Asensio Torrado"
					portrait_path = "gfx/leaders/Europe/Portrait_Europe_More_Generic_land_2.dds"
					traits = { defensive_doctrine }
					skill = 2
					attack_skill = 1
					defense_skill = 3
					planning_skill = 2
					logistics_skill = 1
				}
				create_corps_commander = {
	               name = "Pozas Perea"
	               portrait_path = "gfx/leaders/SPR/Portrait_Spain_Pozas.dds"
	               traits = { cavalry_officer old_guard }
	               skill = 2
	               attack_skill = 2
                   defense_skill = 1
                   planning_skill = 2
                   logistics_skill = 2
                }
				create_corps_commander = {
					name = "Toribio Martínez Cabrera"
					portrait_path = "gfx/leaders/Europe/Portrait_Europe_Generic_3.dds"
					traits = { trait_mountaineer }
					skill = 2
					attack_skill = 1
					defense_skill = 2
					planning_skill = 2
					logistics_skill = 2
				}
				create_field_marshal = {
					name = "Juan Hernández Saravia"
					portrait_path = "gfx/leaders/SPR/Portrait_Spain_Saravia.dds"
					traits = { thorough_planner }
					skill = 1
					attack_skill = 1
					defense_skill = 2
					planning_skill = 2
					logistics_skill = 3
				}
				load_oob = "SPR_Civil_War"
					set_equipment_fraction = 0.9
					set_stability = 0.7
					set_war_support = 0.7
					country_event = { id = spain.3 days = 1 }
					country_event = { id = veren.6 days = 12 }
					add_popularity = {
						ideology = democratic
						popularity = 0.10
				}
				add_popularity = {
						ideology = communism
						popularity = 0.20
				}
				add_ideas = SPR_civil_war_defence
			}
			random_country = {
				limit = {
					original_tag = SPR
					has_government = fascism
				}
			}
			news_event = { hours = 6 id = news.63 }
			set_global_flag = spanish_civil_war
			save_global_event_target_as = NAT_SPAIN
			load_oob = "SPA_Civil_War"
			set_equipment_fraction = 0.9
			set_stability = 0.7
				set_war_support = 0.75
			
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
			}
			set_popularities = {
				democratic = 18
				fascism = 70
				communism = 6
				neutrality = 6
			}

			country_event = { id = spain.2 days = 7 }
			load_focus_tree = Spain_focus
			complete_national_focus = SPR_Political_Effort
			complete_national_focus = SPR_Fascism
						create_field_marshal = {
							name = "Francisco Franco"
							picture = "Portrait_Spain_Francisco_Franco.dds"
							traits = { offensive_doctrine politically_connected }
							skill = 2
							attack_skill = 2
							defense_skill = 2
							planning_skill = 2
							logistics_skill = 3
						}
						create_corps_commander = {
							name = "Severiano Martínez Anido"
							portrait_path = "gfx/leaders/Europe/Portrait_Europe_Generic_1.dds"
							traits = { infantry_officer politically_connected }
							skill = 2
							attack_skill = 2
							defense_skill = 2
							planning_skill = 2
							logistics_skill = 2
						}
						create_corps_commander = {
							name = "José Monasterio Ituarte"
							portrait_path = "gfx/leaders/Europe/Portrait_Europe_More_Generic_2.dds"
							traits = { harsh_leader politically_connected }
							skill = 2
							attack_skill = 2
							defense_skill = 3
							planning_skill = 1
							logistics_skill = 2
						}
						create_corps_commander = {
							name = "Juan A"
							portrait_path = "gfx/leaders/SPR/Portrait_SPR_Juan.dds"
							traits = { cavalry_officer offensive_doctrine }
							skill = 2
							attack_skill = 2
							defense_skill = 2
							planning_skill = 2
							logistics_skill = 1
						}
				}
		
		custom_effect_tooltip = nationalists_chosen
	}

}

# Nationalists: Seek Support
country_event = {
	id = spain.2
	title = spain.2.t
	desc = spain.2.d
	picture = GFX_report_event_spain_civil_war_volunteers_01
	
	is_triggered_only = yes

	option = {
		name = spain.2.a
		ai_chance = { factor = 1 }
		every_country = {
			limit = {
				has_government = fascism
				NOT = { original_tag = SPR }
			}
			country_event = { id = spain.4 days = 1 }
		}
		if = {
			limit = {
				POR = { NOT = { has_government = communism } }
			}
			POR = { country_event = { id = spain.4 days = 1 } }
		}
	}

	option = {
		name = spain.2.b
		add_political_power = 40
		ai_chance = { factor = 0 }
	}
}

# Republicans: Seek Support
country_event = {
	id = spain.3
	title = spain.2.t
	desc = spain.3.d
	picture = GFX_report_event_spain_civil_war_volunteers_02
	
	is_triggered_only = yes

	option = {
		name = spain.3.a
		ai_chance = { factor = 1 }
		every_country = {
			limit = {
				has_government = communism
				NOT = { tag = SPR }
			}
			country_event = { id = spain.5 days = 1 }
		}
		if = {
			limit = {
				MEX = { NOT = { has_government = fascism } }
			}
			MEX = { country_event = { id = spain.5 days = 1 } }
		}
	}

	option = {
		name = spain.3.b
		add_political_power = 40
		ai_chance = { factor = 0 }
	}
}

# Nationalist Spain Wants Our Help
country_event = {
	id = spain.4
	title = spain.4.t
	desc = spain.4.d
	picture = GFX_report_event_spain_civil_war_franco_thank_you
	
	is_triggered_only = yes

	option = {
		name = spain.4.a
		set_country_flag = promised_help_nationalist_spain
		custom_effect_tooltip = spain.4.a.tt
		hidden_effect = {
		country_event = { id = spain.6 days = 40 }
		}
	}

	option = {
		name = spain.4.b
		
	}
}

# Republican Spain Wants Our Help
country_event = {
	id = spain.5
	title = spain.5.t
	desc = spain.5.d
	picture = GFX_report_event_spanish_civil_war_volunteers
	
	is_triggered_only = yes

	option = {
		name = spain.5.a
		set_country_flag = promised_help_republican_spain
		custom_effect_tooltip = spain.4.a.tt
		hidden_effect = {
		country_event = { id = spain.7 days = 40 }
		}
	}

	option = {
		name = spain.5.b
		
	}
}

# Nationalist Spain Appreciates our Help
country_event = {
	id = spain.6
	title = { 
	text = spain.6.tyes
	trigger = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
	}
	title = { 
	text = spain.6.t
	trigger = {
		NOT = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		}
	}
	desc = { 
	text = spain.6.d
	trigger = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
	}
	desc = { 
	text = spain.6.dno
	trigger = {
		NOT = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		}
	}
	picture = GFX_report_event_spain_civil_war_franco_thank_you
	
	is_triggered_only = yes

	option = {
		name = spain.6.a
		trigger = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		random_country = {
			limit = {
				original_tag = SPR
				has_government = fascism
			}
			add_opinion_modifier = { target = ROOT modifier = lend_leased_spanish_civil_war }
		}
	}
	
	option = {
		name = spain.6.b
		custom_effect_tooltip = send_ll_tooltip2
		trigger = {
		NOT = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		}
		hidden_effect = {
		   country_event = { id = spain.66 days = 60 }
		}		
	}
}

# Republican Spain Appreciates our Help
country_event = {
	id = spain.7
	title = { 
	text = spain.7.tyes
	trigger = {
	    	is_lend_leasing = SPR
		}
	}
	title = { 
	text = spain.7.t
	trigger = {
	    	NOT = {
	        	is_lend_leasing = SPR
	    	}
		}
	}
	desc = { 
	text = spain.7.d
	    trigger = {
	    	is_lend_leasing = SPR
		}
	}
	desc = { 
	text = spain.7.dno
    	trigger = {
	    	NOT = {
	        	is_lend_leasing = SPR
	    	}
		}
	}
	picture = GFX_report_event_spanish_civil_war_volunteers
	
	is_triggered_only = yes

	option = {
		name = spain.7.a
		trigger = {
		is_lend_leasing = SPR
		}
		SPR = { add_opinion_modifier = { target = ROOT modifier = lend_leased_spanish_civil_war } }
	}
	
	option = {
		name = spain.7.b
		custom_effect_tooltip = send_ll_tooltip2
		trigger = {
		NOT = {
		is_lend_leasing = SPR
		}
		}
		hidden_effect = {
		   country_event = { id = spain.77 days = 60 }
		}		
	}
}

# Nationalist Spain Appreciates our Help
country_event = {
	id = spain.66
	title = { 
	text = spain.6.tyes
	trigger = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
	}
	title = { 
	text = spain.6.t
	trigger = {
		NOT = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		}
	}
	desc = { 
	text = spain.6.d
	trigger = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
	}
	desc = { 
	text = spain.6.dno
	trigger = {
		NOT = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		}
	}
	picture = GFX_report_event_spain_civil_war_franco_thank_you
	
	is_triggered_only = yes

	option = {
		name = spain.6.a
		trigger = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		random_country = {
			limit = {
				original_tag = SPR
				has_government = fascism
			}
			add_opinion_modifier = { target = ROOT modifier = lend_leased_spanish_civil_war }
		}
	}
	
	option = {
		name = spain.66.b
		trigger = {
		NOT = {
		any_other_country = {
			original_tag = SPR
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
		}
		}	
		add_popularity = {
			ideology = fascism
			popularity = -0.03
		}
		add_war_support = -0.03
	}
}

# Republican Spain Appreciates our Help
country_event = {
	id = spain.77
	title = { 
	text = spain.7.tyes
	trigger = {
	    	is_lend_leasing = SPR
		}
	}
	title = { 
	text = spain.7.t
	trigger = {
	    	NOT = {
	        	is_lend_leasing = SPR
	    	}
		}
	}
	desc = { 
	text = spain.7.d
	    trigger = {
	    	is_lend_leasing = SPR
		}
	}
	desc = { 
	text = spain.7.dno
    	trigger = {
	    	NOT = {
	        	is_lend_leasing = SPR
	    	}
		}
	}
	picture = GFX_report_event_spain_civil_war_volunteers_02
	
	is_triggered_only = yes

	option = {
		name = spain.77.a
		trigger = {
		is_lend_leasing = SPR
		}
		SPR = { add_opinion_modifier = { target = ROOT modifier = lend_leased_spanish_civil_war } }
	}
	
	option = {
		name = spain.77.b
		trigger = {
		NOT = {
		is_lend_leasing = SPR
		}
		}
		add_popularity = {
			ideology = communism
			popularity = -0.03
		}
		add_war_support = -0.03
	}
}

# Civil war over. Move Capital
country_event = {
	id = spain.8
	title = spain.8.t
	desc = spain.8.d
	picture = GFX_report_event_generic_city
	
	trigger = {
		original_tag = SPR
		has_government = fascism
		has_global_flag = nationalist_victory
		owns_state = 41
	}

	fire_only_once = yes

	mean_time_to_happen = {
		days = 2
	}

	option = {
		ai_chance = { factor = 1 }
		name = spain.8.a
		set_capital = 41
		add_ideas = neutrality_idea
	}
	option = {
		ai_chance = { factor = 0 }
		name = spain.8.b
	}
}

# Election of 1936
country_event = {
	id = spain.9
	title = spain.9.t
	desc = spain.9.d
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	fire_only_once = yes

	trigger = {
		tag = SPR
		date > 1936.2.14
	}

	# Popular Front
	option = {
		ai_chance = { factor = 1 }
		name = spain.9.a
		add_popularity = {
			ideology = communism
			popularity = 0.1
		}
	}

}


country_event = {
	id = spain.11
	title = spain.11.t
	desc = spain.11.d
	picture = GFX_report_event_spanish_parade
	
	trigger = {
		tag = SPR
		or = {
		date > 1938.1.1
		has_government = communism
		has_global_flag = scw_over }
		is_ai = yes
	}

	fire_only_once = yes

	mean_time_to_happen = {
		days = 1
	}

	option = {
		ai_chance = { factor = 1 }
		name = spain.11.a
		
		add_ideas = neutrality_idea
	}
	
}
