###########################
# Soviet Events
###########################

add_namespace = soviet

# Romania surrenders Bessarabia
country_event = {
	id = soviet.4
	title = soviet.4.t
	desc = soviet.4.d
	picture = GFX_report_event_soviet_tank_parade
	
	is_triggered_only = yes
	
	option = {
		name = soviet.4.a
		ROOT = { #Scoping for tooltip reasons
			if = { #NSB note: Now this will check for ownership and control so that in edge cases where there might be more than one controller, it won't break.
				limit = {
					78 = { is_owned_and_controlled_by = FROM }
				}
				transfer_state = 78
			}
			if = {
				limit = {
					80 = { is_owned_and_controlled_by = FROM }
				}
				transfer_state = 80
			}
			if = {
				limit = {
					766 = { is_owned_and_controlled_by = FROM }
				}
				transfer_state = 766
			}
		}
		hidden_effect = {
			SOV = {
				country_event = { days = 1 id = news.10 }
			}
			news_event = { id = news.199 }
		}
	}
}

# Romania refuses to surrender Bessarabia
country_event = {
	id = soviet.5
	title = soviet.5.t
	desc = soviet.5.d
	picture = GFX_report_event_soviet_tanks
	
	is_triggered_only = yes
	
	option = {
		name = soviet.5.a
		create_wargoal = {
			type = take_state
			target = ROM
			generator = { 78 }
		}
		hidden_effect = {
			SOV = {
				country_event = { days = 1 id = news.11 }
			}
		}
	}
}

# Estonia Surrenders
country_event = {
	id = soviet.6
	title = soviet.6.t
	desc = soviet.6.d
	picture = GFX_news_event_034
	
	is_triggered_only = yes
	
	option = {
		name = soviet.6.a
		annex_country = { target = EST }
		hidden_effect = {
			news_event = { id = news.723 }
		}
	}
}

# Estonia Refuses
country_event = {
	id = soviet.7
	title = soviet.7.t
	desc = soviet.7.d
	picture = GFX_report_event_soviet_bikes
	
	is_triggered_only = yes
	
	option = {
		name = soviet.7.a
		create_wargoal = {
			type = annex_everything
			target = EST
		}		
	}
}

# Latvia Surrenders
country_event = {
	id = soviet.8
	title = soviet.8.t
	desc = soviet.8.d
	picture = GFX_report_event_soviet_bikes
	
	is_triggered_only = yes
	
	option = {
		name = soviet.8.a
		annex_country = { target = LAT }
		hidden_effect = {
			news_event = { id = news.721 }
		}
	}
}

# Latvia Refuses
country_event = {
	id = soviet.9
	title = soviet.9.t
	desc = soviet.9.d
	picture = GFX_report_event_stalin_propaganda
	
	is_triggered_only = yes
	
	option = {
		name = soviet.9.a
		create_wargoal = {
			type = annex_everything
			target = LAT
		}		
	}
}

# Lithuania Surrenders
country_event = {
	id = soviet.10
	title = soviet.10.t
	desc = soviet.10.d
	picture = GFX_news_event_034
	
	is_triggered_only = yes
	
	option = {
		name = soviet.10.a
		annex_country = { target = LIT }
		hidden_effect = {
			news_event = { id = news.722 }
		}
	}
}

# Lithuania Refuses
country_event = {
	id = soviet.11
	title = soviet.11.t
	desc = soviet.11.d
	picture = GFX_report_event_stalin_propaganda
	
	is_triggered_only = yes
	
	option = {
		name = soviet.11.a
		create_wargoal = {
			type = annex_everything
			target = LIT
		}		
	}
}

# Finland Accepts Demands
country_event = {
	id = soviet.12
	title = soviet.12.t
	desc = soviet.12.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.12.a
		SOV = { 
			transfer_state = 146
			transfer_state = 147
		}
		set_global_flag = winterwar
		hidden_effect = {
			FIN = {
				add_ideas = FIN_refuge
			}
		}
		hidden_effect = {
			SOV = {
				country_event = { days = 1 id = news.13 }
			}
		}
	}
}

# Finland Refuses Demands
country_event = {
	id = soviet.13
	title = soviet.13.t
	desc = soviet.13.d
	picture = GFX_report_event_soviet_tanks_snow
	
	is_triggered_only = yes
	
	option = {
		name = soviet.13.a
		create_wargoal = {
			type = take_state
			target = FIN
			generator = { 146 }
		}				
		hidden_effect = {
			SOV = {
				country_event = { days = 1 id = news.12 }	
				set_global_flag = finland_take_this
			}
		}
	}
}

# Tannu Tuva is asked to join the USSR
country_event = {
	id = soviet.14
	title = soviet.14.t
	desc = soviet.14.d
	picture = GFX_report_event_stalin_01
	
	is_triggered_only = yes
	
	option = { # Accept
		name = soviet.14.a
		ai_chance = { factor = 100 }
		SOV = {
			country_event = { id = soviet.16 }
		}
		custom_effect_tooltip = GAME_OVER_TT
	}
	option = { # Refuse
		name = soviet.14.b
		SOV = {
			country_event = { id = soviet.15 }
		}
	}
}

# Tannu Tuva declines the offer
country_event = {
	id = soviet.15
	title = soviet.15.t
	desc = soviet.15.d
	picture = GFX_report_event_soviet_soldiers2
	
	is_triggered_only = yes
	
	option = {
		name = soviet.15.a
	}
}

# Tannu Tuva accepts the offer
country_event = {
	id = soviet.16
	title = soviet.16.t
	desc = soviet.16.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.16.a
		annex_country = { target = TAN }
		hidden_effect = {
			SOV = {
				country_event = { days = 1 id = news.14 }
			}
		}
	}
}

# Mongolia is asked to join the USSR
country_event = {
	id = soviet.140
	title = soviet.140.t
	desc = soviet.140.d
	picture = GFX_report_event_stalin_01
	
	is_triggered_only = yes
	
	option = { # Accept
		name = soviet.140.a
		ai_chance = { factor = 100 }
		SOV = {
			country_event = { id = soviet.160 }
		}
		add_popularity = {
			ideology = communism
			popularity = 0.15
		}
		effect_tooltip = {
			SOV = {
				puppet = MON
			}
		}
	}
	option = { # Refuse
		name = soviet.140.b
		SOV = {
			country_event = { id = soviet.150 }
		}
	}
}
# Mon declines the offer
country_event = {
	id = soviet.150
	title = soviet.150.t
	desc = soviet.150.d
	picture = GFX_report_event_soviet_soldiers2
	
	is_triggered_only = yes
	
	option = {
		name = soviet.150.a
	}
}

# mon accepts the offer
country_event = {
	id = soviet.160
	title = soviet.160.t
	desc = soviet.160.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.160.a
		if = {
	limit = {
		OR = {
			has_dlc = "Together for Victory"
			has_dlc = "Man the Guns"
		}
	}
	set_autonomy = {
		target = MON
		autonomous_state = autonomy_Soviet_Supervised_State
		freedom_level = 0.65
	}
	else = {
		puppet = MON
	}
}
		hidden_effect = {
			SOV = {
				# todo country_event = { days = 1 id = news.14 }
			}
		}
	}
}


# Soviet Union Cedes Land (Japan)
country_event = {
	id = soviet.23
	title = soviet.23.t
	desc = soviet.23.d
	picture = GFX_report_event_soviet_bikes
	
	is_triggered_only = yes
	
	option = {
		name = soviet.23.a
		transfer_state = 655
	}
}

# Great Purge - Begins
country_event = {
	id = soviet.24
	title = soviet.24.t
	desc = soviet.24.d
	picture = GFX_report_event_soviet_purge_speech
	
	is_triggered_only = yes
	
	option = {
		name = soviet.24.a
		add_stability = -0.05
	}
}

# Great Purge - Trial of the Anti-Soviet Trotskyist Center
country_event = {
	id = soviet.25
	title = soviet.25.t
	desc = soviet.25.d
	picture = GFX_report_event_soviet_purge_trial

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		NOT = { has_completed_focus = SOV_great_purge }
		focus_progress = {
			focus = SOV_great_purge
			progress > 0.25
		}
	}

	immediate = {
		country_event = { id = soviet.26 days = 110 }
	}


	option = {
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		name = soviet.25.a
		custom_effect_tooltip = remove_political_advisor
        show_ideas_tooltip = SOV_lev_kamenev
		show_ideas_tooltip = SOV_grigory_zinovyev
		hidden_effect = { retire_character = SOV_grigory_zinovyev }
		hidden_effect = { retire_character = SOV_lev_kamenev }
		
	}
	option = {
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		name = soviet.25.b
		custom_effect_tooltip = remove_political_advisor
        show_ideas_tooltip = SOV_nikita_khrushchev
		hidden_effect = { retire_character = nikita_khrushchev}
	}
	option = {
		ai_chance = {
			factor = 30
		}
		name = soviet.25.c
		add_political_power = -50
		custom_effect_tooltip = remove_political_advisor
		show_ideas_tooltip = SOV_vsevolod_merkulov
		hidden_effect = { retire_character = SOV_vsevolod_merkulov}
	}
	option = {
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		trigger= {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		name = soviet.25.e
		set_country_flag = no_political_purge
		custom_effect_tooltip = soviet.27_tt2
	}
}

# Great Purge - Secret Trial of the Generals
country_event = {
	id = soviet.26
	title = soviet.26.t
	desc = soviet.26.d
	picture = GFX_report_event_soviet_purge_officers_01

	is_triggered_only = yes
        immediate = {
		country_event = { id = soviet.27 days = 273 }
	}

	option = {
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		name = soviet.26.a
		
		hidden_effect = { retire_character = pyotr_smirnov }
		hidden_effect = { retire_character = mikhail_frinovsky }
		hidden_effect = { retire_character = SOV_mikhail_tukhachevsky }
		
		
		set_country_flag = purge_1_group_a
		set_country_flag = purge_dd
		custom_effect_tooltip = remove_theorist
		show_ideas_tooltip = mikhail_tukhachevsky
		custom_effect_tooltip = remove_chief_of_navy
		show_ideas_tooltip = pyotr_smirnov
		show_ideas_tooltip = mikhail_frinovsky

		add_ideas = officers_purged
		add_ideas = navy_purged_2
		hidden_effect = {		
			country_event = { id = soviet.429 days = 730 }
			activate_mission = officer_purges
		}
	}
	option = {
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		name = soviet.26.b
		
		hidden_effect = { retire_character = SOV_alexander_yegorov }
		hidden_effect = { retire_character = SOV_konstantin_rokossovsky}
		hidden_effect = { retire_character = SOV_semyon_timoshenko }
		hidden_effect = { retire_character = konstantin_vershinin }

		
		set_country_flag = purge_1_group_b
		set_country_flag = purge_dd
		custom_effect_tooltip = remove_chief_of_army
		show_ideas_tooltip = semyon_timoshenko
		show_ideas_tooltip = SOV_alexander_yegorov
		custom_effect_tooltip = remove_military_high_command
		show_ideas_tooltip = konstantin_rokossovsky
		custom_effect_tooltip = remove_chief_of_airforce
		show_ideas_tooltip = konstantin_vershinin
		
	
		add_ideas = officers_purged
		add_ideas = air_purged_2
	    hidden_effect = {
			country_event = { id = soviet.429 days = 730 }
			activate_mission = officer_purges			
		}
	}
	# REVISIT Balance, since the latter removes more unit leaders
	option = {
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		name = soviet.26.e
		set_country_flag = purge_1_no_purge 
		trigger= {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		add_popularity = {
			ideology = communism
			popularity = -0.1
		}
		custom_effect_tooltip = soviet.27_tt2
	}
}

# Great Purge - Trial of the 21
country_event = {
	id = soviet.27
	title = soviet.27.t
	desc = soviet.27.d
	picture = GFX_report_event_soviet_purge_officers_02

	is_triggered_only = yes

	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.27.a

		#hidden_effect = { retire_character = SOV_nikolai_yezhov} # he will be removed later
		#hidden_effect = { retire_character = yakov_smushkevich} not until 1941 purge
		#hidden_effect = { retire_character = pavel_rychagov} not until 1941 purge
		
		hidden_effect = { retire_character = SOV_genrikh_yagoda }
		hidden_effect = { retire_character = SOV_nikolay_bukharin }
		hidden_effect = { retire_character = SOV_aleksey_rykov }
		
		custom_effect_tooltip = remove_political_advisor
		show_ideas_tooltip = SOV_genrikh_yagoda
		show_ideas_tooltip = SOV_nikolay_bukharin 
		show_ideas_tooltip = SOV_aleksey_rykov
		
		custom_effect_tooltip = soviet.27_tt

		add_timed_idea = {
			idea = officers_purged_b
			days = 1350
	    }
		add_stability = -0.03
	}
	option = {
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		trigger = {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		add_popularity = {
			ideology = communism
			popularity = -0.1
		}
		add_stability = -0.03
		name = soviet.27.c
		set_country_flag = purge_2_no_purge
		custom_effect_tooltip = soviet.27_tt2
	}
}


# Trotsykist Coup
country_event = {
	id = soviet.28
	title = soviet.28.t
	desc = soviet.28.d
	picture = GFX_report_event_soviet_purge_politicians

	fire_only_once = yes
	
	trigger = {
		has_country_flag = SOV_soviet.48_trotsky
		tag = SOV
		NOT = {
			MEX = {
				has_country_leader = { name = "Leon Trotsky" ruling_only = yes }
			}
		}
	}

	mean_time_to_happen = {
		days = 90
		#modifier = {
		#	factor = 1.25
		#	OR = {
		#		has_country_flag = purged_kalinin
		#		has_country_flag = purged_khrushchev
		#		has_country_flag = purged_party_members
		#	}
		#}	
	}

	option = {
		name = soviet.28.a
		set_country_flag = counter_purge
		if = {
			limit = { has_idea = trotskyite_plot_purged }
			remove_ideas = trotskyite_plot_purged
		}
		if = {
			limit = { has_idea = trotskyite_plot }
			remove_ideas = trotskyite_plot
		}
		kill_country_leader = yes
		create_country_leader = {
			name = "Leon Trotsky"
			desc = "POLITICS_LEON_TROTSKY_DESC"
			picture = "Portrait_Leon_Trotsky.dds"
			expire = "1965.1.1"
			ideology = leninism
			traits = {
				permanent_revolutionary
			}
		}
		remove_ideas = mikhail_kalinin
		remove_ideas = ivan_konev
		remove_unit_leader = 408
		remove_ideas = pavel_zhigarev
		remove_ideas = stepan_krasovsky
		remove_ideas = arseniy_golovko
		remove_unit_leader = 409
		remove_ideas = georgy_zhukov
		remove_unit_leader = 410
		remove_ideas = sergey_gorshkov
		remove_unit_leader = 411
		remove_ideas = sergei_rudenko
		remove_ideas = nikita_khrushchev
		remove_ideas = konstantin_rodzaevsky
		add_stability = -0.08
		add_timed_idea = {
			idea = officers_purged_7
			days = 684
		}
		hidden_effect = {
			country_event = { id = soviet.43 days = 246 }				
		}
		start_civil_war = {
			ideology = neutrality
			size = 0.18
			keep_unit_leaders = { 401 402 407 410 406 405 403 407 404 }
		}
		hidden_effect = {
			random_country = {
				limit = {
					original_tag = SOV
					has_government = neutrality
				}
				kill_country_leader = yes
				create_country_leader = {
					name = "Ivan Konev"
					desc = "POLITICS_IVAN_KONEV_DESC"
					picture = "Portrait_Soviet_Ivan_Konev.dds"
					expire = "1965.1.1"
					ideology = oligarchism
					traits = {
					war_hero
					}
				}
				if = { limit = { SOV = { has_idea = SOV_idea_2_5_year_plan } } 
				     add_ideas = { SOV_idea_2_5_year_plan }
				}
				if = { limit = { SOV = { has_idea = SOV_idea_3_5_year_plan } } 
				     add_ideas = { SOV_idea_3_5_year_plan }
				}
			}
			news_event = { hours = 6 id = news.221 }
		}
	}
}

# France national focus -  requests to join commitern
country_event = {
	id = soviet.29
	title = soviet.29.t
	desc = soviet.29.d
	picture = GFX_news_event_stalin

	is_triggered_only = yes
		
	option = {
		name = soviet.29.a
		SOV = { add_to_faction = FRA }
		FRA = {
			add_ai_strategy = {
				type = alliance
				id = "SOV"
				value = 200
			}
		}
		hidden_effect = {
			news_event = { hours = 6 id = news.180 }
		}
	}
	option = {
		name = soviet.29.b
		ai_chance = { factor = 0 }
		FRA = {
			add_opinion_modifier = {
				target = SOV
				modifier = SOV_FRA_join_comintern_reject
			}
		}
	}
}

# comintern_influence removed due to war with common enemy
country_event = {
	id = soviet.100
	title = soviet.100.t
	desc = soviet.100.d
	picture = GFX_report_event_new_zealand_communist
	
	trigger = {
		has_idea = comintern_influence
		has_war = yes
		SOV = { has_war = yes }
		NOT = { has_war_with = SOV }
		any_enemy_country = {
			has_war_with = SOV
		}
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	option = {
		name = soviet.100.a
		remove_ideas = comintern_influence
	}
}

# Demand Bessarabia
country_event = {
	id = soviet.30
	title = soviet.30.t
	desc = soviet.30.d
	picture = GFX_report_event_soviet_bikes

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		78 = {
			is_claimed_by = SOV
			is_owned_by = ROM
			is_controlled_by = ROM
		}
		NOT = { has_war_with = ROM }
	}
		
	option = {
		name = soviet.30.a
		ai_chance = { factor = 1 } # historical mod
		hidden_effect = { 
			ROM = { 
				country_event = { days = 2 id = romania.1 }
			}
		}
	}	
	option = {
		name = soviet.30.b
		ai_chance = { factor = 0 }
		#
	}
}

# Demand Karjala
country_event = {
	id = soviet.31
	title = soviet.31.t
	desc = soviet.31.d
	picture = GFX_report_event_soviet_bikes

	is_triggered_only = yes
	
	trigger = {
		tag = SOV
		146 = {
			is_claimed_by = SOV
			is_owned_by = FIN
		}
	}
	
	immediate = { 
	    if = { limit = { has_idea = SOV_molotov_ribbentrop_pact } 
        	FIN = {
	        	add_timed_idea = {
			    	idea = fate_of_finland
			    	days = 365
		    	}
	    	} 
	    } 
	}
	
		
	option = {
		name = soviet.31.a
		FIN = { country_event = { days = 2 id = finland.1 } }
		ai_chance = { factor = 1 }
	}
	option = {
		trigger= {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		name = soviet.31.b
		ai_chance = { factor = 0 }
		#
	}
}

# Oppress Estonia
country_event = {
	id = soviet.32
	title = soviet.32.t
	desc = soviet.32.d
	picture = GFX_report_event_soviet_in_riga

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		EST = {
			any_owned_state = { is_claimed_by = SOV }
		}
	}
	
		
	option = {
		name = soviet.32.a
		EST = { country_event = { days = 2 id = baltic.1 } }
		ai_chance = { factor = 1 }
	}
	option = {
		trigger= {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		name = soviet.32.b
		ai_chance = { factor = 0 }
		#
	}
}

# Oppress Latvia
country_event = {
	id = soviet.33
	title = soviet.33.t
	desc = soviet.33.d
	picture = GFX_report_event_soviet_in_riga

	fire_only_once = yes
	trigger = {
		tag = SOV
		LAT = {
			any_owned_state = { is_claimed_by = SOV }
		}
	}
		
	option = {
		name = soviet.33.a
		LAT = { country_event = { days = 2 id = baltic.2 } }
		ai_chance = { factor = 1 }
	}
	option = {
		trigger= {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		name = soviet.33.b
		ai_chance = { factor = 0 }
		#
	}
}

# Oppress Lithuania 
country_event = {
	id = soviet.34
	title = soviet.34.t
	desc = soviet.34.d
	picture = GFX_report_event_soviet_in_riga

	fire_only_once = yes
	trigger = {
		tag = SOV
		LIT = {
			any_owned_state = { is_claimed_by = SOV }
		}
	}
		
	option = {
		name = soviet.34.a
		LIT = { country_event = { days = 2 id = baltic.3 } }
		ai_chance = { factor = 1 }
	}
	option = {
		trigger= {
	    	NOT = {
	    	has_game_rule = {
				rule = must_hist_winterwar
				option = block
		    	}
			}
		}
		name = soviet.34.b
		ai_chance = { factor = 0 }
		#
	}
}



# Communist government in FROM baltic country and they wish to be annexed
country_event = {
	id = soviet.35
	title = soviet.35.t
	desc = soviet.35.d
	picture = GFX_news_event_stalin

	is_triggered_only = yes

	option = {
		name = soviet.35.a
		ai_chance = { factor = 100 }

		effect_tooltip = {
			if = {
				limit = { FROM = { tag = LIT } }
			 	SOV = {
			 		annex_country = {
					target = LIT
					transfer_troops = yes } 
					add_named_threat = { threat = 2 name = soviet.35_threat_LIT }
				}
			}
			if = {
				limit = { FROM = { tag = FIN } } 
			 	SOV = { 
			 		annex_country = {
					target = FIN
					transfer_troops = yes } 
					add_named_threat = { threat = 5 name = soviet.35_threat_FIN }
				}
			}
			if = {
				limit = { FROM = { tag = EST } } 
			 	SOV = { 
			 		annex_country = {
					target = EST
					transfer_troops = yes } 
					add_named_threat = { threat = 2 name = soviet.35_threat_EST }
				}
			}
			if = {
				limit = { FROM = { tag = LAT } } 
			 	SOV = {
			 		annex_country = {
					target = LAT
					transfer_troops = yes } 
					add_named_threat = { threat = 2 name = soviet.35_threat_LAT }
				}
			}
		} 

		hidden_effect = {

			 FROM = {
			 	country_event = { id = baltic.6 hours = 6}
			 }			
		}
	}
	option = {
		name = soviet.35.b
		ai_chance = { factor = 0 }
	}
}

# Communist government in FROM baltic country and they wish to be part puppet
country_event = {
	id = soviet.36
	title = soviet.36.t
	desc = soviet.36.d
	picture = GFX_news_event_stalin

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			FROM = {
				save_event_target_as = baltic
			}
		}
	}

	option = {
		name = soviet.36.a
		if = {
			limit = {
				FROM = { is_puppet = no }
			}
			SOV = { puppet = FROM }
		}
		ai_chance = { factor = 100 }
			if = {
				limit = { FROM = { tag = LIT } }
				add_named_threat = { threat = 1 name = soviet.36_threat_LIT }
			}	
			if = {
				limit = { FROM = { tag = FIN } }
				add_named_threat = { threat = 2 name = soviet.36_threat_FIN }
			}			
			if = {
				limit = { FROM = { tag = EST } }
				add_named_threat = { threat = 1 name = soviet.36_threat_EST }
			}			
			if = {
				limit = { FROM = { tag = LAT } }
				add_named_threat = { threat = 1 name = soviet.36_threat_LAT }
			}		

		#trigger news event
		hidden_effect = {
			news_event =  { id = news.70 days = 1}
		}		
	}
	option = {
		name = soviet.36.b
		ai_chance = { factor = 0 }
	}
}

# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.37
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged
			add_timed_idea = {
				idea = officers_purged_2
				days = 1694
			}
			country_event = { id = soviet.38 days = 236 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.38
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_2 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_2
			add_timed_idea = {
				idea = officers_purged_3
				days = 1428
			}
			if = {
				limit = { has_idea = SOV_great_patriotic_war }
				remove_ideas = SOV_great_patriotic_war
				add_ideas = SOV_great_patriotic_war_2
			}
			country_event = { id = soviet.39 days = 266 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.39
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_3 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_3
			add_timed_idea = {
				idea = officers_purged_4
				days = 1162
			}
			country_event = { id = soviet.40 days = 236 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.40
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_4 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_4
			add_timed_idea = {
				idea = officers_purged_5
				days = 976
			}
			if = {
				limit = { has_idea = SOV_great_patriotic_war_2 }
				remove_ideas = SOV_great_patriotic_war_2
				add_ideas = SOV_great_patriotic_war_3
			}			
			country_event = { id = soviet.41 days = 196 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.41
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_5 }

	immediate = {
	hidden_effect = {
			remove_ideas = officers_purged_5
			add_timed_idea = {
				idea = officers_purged_6
				days = 730
			}		
			country_event = { id = soviet.42 days = 146 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.42
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_6 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_6
			add_timed_idea = {
				idea = officers_purged_7
				days = 584
			}
			if = {
				limit = { has_idea = SOV_great_patriotic_war_3 }
				remove_ideas = SOV_great_patriotic_war_3
				add_ideas = SOV_great_patriotic_war_4
			}			
			country_event = { id = soviet.43 days = 146 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.43
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_7 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_7
			add_timed_idea = {
				idea = officers_purged_8
				days = 438
			}
			country_event = { id = soviet.44 days = 146 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.44
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_8 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_8
			add_timed_idea = {
				idea = officers_purged_9
				days = 292
			}
			if = {
				limit = { has_idea = SOV_great_patriotic_war_4 }
				remove_ideas = SOV_great_patriotic_war_4
				add_ideas = SOV_great_patriotic_war_5
			}					
			country_event = { id = soviet.45 days = 146 }
		}
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - New officers less dumb. Regaining org
country_event = {
	id = soviet.45
	title = soviet.37.t
	desc = soviet.37.d
	picture = GFX_news_event_purge

	is_triggered_only = yes

	trigger = {	has_idea = officers_purged_9 }

	immediate = {
		hidden_effect = {
			remove_ideas = officers_purged_9
			add_timed_idea = {
				idea = officers_purged_10
				days = 146
			}
			country_event = {
				id = soviet.397
				days = 70 # check when this is
			}
		}
		country_event = { id = soviet.47 days = 146 }
	}
	option = {
		name = soviet.37.a
		custom_effect_tooltip = soviet.37.a_tt
	}
}
# Purge - Fighting defensive war against major
country_event = {
	id = soviet.46
	title = soviet.46.t
	desc = soviet.46.d
	picture = GFX_report_event_russian_defense_with_injured_soldier

	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 40
	}

	trigger = {
	tag = SOV
has_war = yes
surrender_progress > 0.1
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_idea = officers_purged
						has_idea = officers_purged_2
					}
				}
				add_ideas = SOV_great_patriotic_war
			}
			if = {
				limit = {
					OR = {
						has_idea = officers_purged_3	
						has_idea = officers_purged_4	
					}
				}
				add_ideas = SOV_great_patriotic_war_2
			}
			if = {
				limit = {
					OR = {
						has_idea = officers_purged_5	
						has_idea = officers_purged_6	
					}
				}
				add_ideas = SOV_great_patriotic_war_3
			}
			if = {
				limit = {
					OR = {
						has_idea = officers_purged_7	
						has_idea = officers_purged_8	
					}
				}
				add_ideas = SOV_great_patriotic_war_4
			}
			if = {
				limit = {
					OR = {
						has_idea = officers_purged_9	
						has_idea = officers_purged_10	
					}
				}
				add_ideas = SOV_great_patriotic_war_5
			}
		}
	}

	option = {
		name = soviet.46.a
		custom_effect_tooltip = soviet.46.a_tt
	}
}
# Purge - Special event to remove patriotic war if it has been added
country_event = {
	id = soviet.47

	hidden = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { has_idea = SOV_great_patriotic_war_5 }
			remove_ideas = SOV_great_patriotic_war_5
		}	
	}
}

#No purges completed - decide what to do
country_event = {
	id = soviet.48
	title = soviet.48.t
	desc = soviet.48.d
	picture = GFX_report_event_soviet_purge_trial

	trigger = {
		has_government = communism
		tag = SOV
		has_global_flag = SOV_fourth_international_fired
		OR = {
		NOT = { has_completed_focus = SOV_great_purge }
		AND = { 
			has_country_flag = no_political_purge
			has_country_flag = purge_1_no_purge
			has_country_flag = purge_2_no_purge
		}
		}
	}

	mean_time_to_happen = {
		days = 90
	}

	fire_only_once = yes

	#Don't invite trotsky
	option = {
    	ai_chance = {
			factor = 2
		}
		name = soviet.48.a
		custom_effect_tooltip = soviet.48.a_tt
		set_country_flag = SOV_soviet.48_notrotsky
	}

	#Invite back Trotsky
	option = {
	    ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		name = soviet.48.b
		custom_effect_tooltip = soviet.48.b_tt
		set_country_flag = SOV_soviet.48_trotsky
	}

}

#No purges massive civil war
country_event = {
	id = soviet.49
	title = soviet.49.t
	desc = soviet.49.d
	picture = GFX_report_event_soviet_soldiers

	trigger = {
		tag = SOV
		has_country_flag = SOV_soviet.48_notrotsky
	}
	
	fire_only_once = yes

	mean_time_to_happen = { days = 10 }

	option = {
		name = soviet.49.a
		start_civil_war = {
			ideology = neutrality
			size = 0.5
			keep_unit_leaders = { 401 402 407 410 406 405 403 407 408 410 411 404 }
		}
		hidden_effect = {
			remove_unit_leader = 412 #Remove Andrey Vlasov
			random_country = {
				limit = {
					original_tag = SOV
					has_government = neutrality
				}
				kill_country_leader = yes
				create_country_leader = {
					name = "Andrey Vlasov"
					desc = "POLITICS_ANDREY_VLASOV_DESC"
					picture = "Portrait_Soviet_Andrey_Vlasov.dds"
					expire = "1965.1.1"
					ideology = moderatism
					traits = {
					}
				}
			}
			news_event = { hours = 3 id = news.220 }
		}
	}
}

#1/4 purges
country_event = {
	id = soviet.50
	title = soviet.50.t
	desc = soviet.50.d
	picture = GFX_news_event_purge

	fire_only_once = yes

	trigger = {
		tag = SOV
		has_country_flag = SOV_purged_1
	}

	mean_time_to_happen = { days = 90 }

	option = {
		name = soviet.50.a
		remove_unit_leader = 412 #Remove Andrey Vlasov
		start_civil_war = {
			ideology = neutrality
			size = 0.3
			keep_unit_leaders = { 401 402 407 410 406 405 403 407 408 410 411 404 }
		}
		hidden_effect = {
			random_country = {
				limit = {
					original_tag = SOV
					has_government = neutrality
				}
				kill_country_leader = yes
				create_country_leader = {
					name = "Andrey Vlasov"
					desc = "POLITICS_ANDREY_VLASOV_DESC"
					picture = "Portrait_Soviet_Andrey_Vlasov.dds"
					expire = "1965.1.1"
					ideology = moderatism
					traits = {
					}
				}
			}
			news_event = { hours = 3 id = news.220 }
		}
	}
}

#2/4 purges
country_event = {
	id = soviet.51
	title = soviet.51.t
	desc = soviet.51.d
	picture = GFX_news_event_purge

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		has_country_flag = SOV_purged_2
	}

	mean_time_to_happen = { days = 90 }

	option = {
		name = soviet.51.a
		remove_unit_leader = 412 #Remove Andrey Vlasov
		start_civil_war = {
			ideology = neutrality
			size = 0.25
			keep_unit_leaders = { 401 402 407 410 406 405 403 407 408 410 411 404 }
		}
		hidden_effect = {
			random_country = {
				limit = {
					original_tag = SOV
					has_government = neutrality
				}
				kill_country_leader = yes
				create_country_leader = {
					name = "Andrey Vlasov"
					desc = "POLITICS_ANDREY_VLASOV_DESC"
					picture = "Portrait_Soviet_Andrey_Vlasov.dds"
					expire = "1965.1.1"
					ideology = moderatism
					traits = {
					}
				}
			}
			news_event = { hours = 3 id = news.220 }
		}
	}
}

#3/4 purges
country_event = {
	id = soviet.52
	title = soviet.52.t
	desc = soviet.52.d
	picture = GFX_report_event_soviet_purge_politicians

	fire_only_once = yes

	trigger = {
		tag = SOV
		has_country_flag = SOV_purged_3
	}

	mean_time_to_happen = { days = 90 }

	option = {
		name = soviet.52.a
		remove_unit_leader = 412 #Remove Andrey Vlasov
		add_stability = -0.15
		start_civil_war = {
			ideology = neutrality
			size = 0.2
			keep_unit_leaders = { 401 402 407 410 406 405 403 407 408 410 411 404 }
		}
		hidden_effect = {
			random_country = {
				limit = {
					original_tag = SOV
					has_government = neutrality
				}
				kill_country_leader = yes
				create_country_leader = {
					name = "Andrey Vlasov"
					desc = "POLITICS_ANDREY_VLASOV_DESC"
					picture = "Portrait_Soviet_Andrey_Vlasov.dds"
					expire = "1965.1.1"
					ideology = moderatism
					traits = {
					}
				}
			}
			news_event = { hours = 3 id = news.220 }
		}
	}

}

#4/4 purges
country_event = {
	id = soviet.53
	title = soviet.53.t
	desc = soviet.53.d
	picture = GFX_report_event_soviet_purge_trial
	
	is_triggered_only = yes

	option = {
		name = soviet.53.a
		remove_ideas = trotskyite_plot_purged
		#remove_unit_leader = 412 #Remove Andrey Vlasov
		#hidden_effect = {
		#	random_country = {
		#		limit = {
		#			original_tag = SOV
		#			has_government = neutrality
		#		}
		#		kill_country_leader = yes
		#		create_country_leader = {
		#			name = "Andrey Vlasov"
		#			desc = "POLITICS_ANDREY_VLASOV_DESC"
		#			picture = "Portrait_Soviet_Andrey_Vlasov.dds"
		#			expire = "1965.1.1"
		#			ideology = moderatism
		#			traits = {
		#			}
		#		}
		#	}
		#}
	}

}


#New Leadership in Russia
country_event = {
	id = soviet.54
	title = soviet.54.t
	desc = {
		text = soviet.54.d_nopurge
		trigger = {
			NOT = {
				has_completed_focus = SOV_great_purge
			}
		}
	}
	desc = {
		text = soviet.54.d_purge
		trigger = {
			has_completed_focus = SOV_great_purge
		}
	}
	picture = GFX_report_event_soviet_purge_speech

	fire_only_once = yes

	trigger = {
		tag = SOV
		NOT = {
			has_government = communism
		}
		has_civil_war = no
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = soviet.54.a
		if = {
			limit = {
				has_idea = trotskyite_plot
			}
			remove_ideas = trotskyite_plot
		}
		if = {
			limit = {
				has_idea = trotskyite_plot_purged
			}
			remove_ideas = trotskyite_plot_purged
		}
		remove_ideas = home_of_revolution
	}
}

country_event = {
	id = soviet.62
	title = soviet.62.t
	desc = soviet.62.d
	picture = GFX_report_event_soldiers_marching

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		has_war_with = GER
		surrender_progress > 0.1
		# german advance check
		or = {
		NOT = { SOV = { has_full_control_of_state = 91 }}
		NOT = { SOV = { has_full_control_of_state = 210 }} # Bryansk
		NOT = { SOV = { has_full_control_of_state = 192 }}
		}
		#date > 1941.9.2
		SOV = { owns_state = 219 } # controls moscow 6380
		NOT = { SOV = { has_full_control_of_state = 202 }}
		NOT = { SOV = { has_full_control_of_state = 206 }}
		is_ai = yes
		#GER = {is_ai = no}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = soviet.55.a
		ai_chance = { factor = 100 }
		
		load_oob = "SOV_proletariat"
		
		hidden_effect = {

				random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				prioritize = { 219 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
				
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 219 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 219 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 219 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 219 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 202 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 202 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 202 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 206 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 206 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 206 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
		}
	}
}


country_event = {
	id = soviet.61
	title = soviet.61.t
	desc = soviet.61.d
	picture = GFX_report_event_soviet_soldiers_city

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		is_ai = yes
		has_war_with = GER
		
		# german advance check
		or = {
		   NOT = { SOV = { controls_state = 263 }}
		   NOT = { SOV = { controls_state = 208 }}
		}
		#controls = 3151
		#SOV = { owns_state = 195 } # controls leningrad 3151
		
		
		GER = {is_ai = no}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = soviet.61.a
		ai_chance = { factor = 100 }
		
		hidden_effect = {
		     load_oob = "SOV_Leningradoffense"
				random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				prioritize = { 195 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
				
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 195 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 195 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 195 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 195 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						prioritize = { 195 }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
						random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.0" 
		owner = SOV
		}
				}
				
				
				random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"229aya  Kavaleriyskaya Div.\" division_template = \"Kavaleriyskaya Diviziya\" start_experience_factor = 0.2" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"228aya  Kavaleriyskaya Div.\" division_template = \"Kavaleriyskaya Diviziya\" start_experience_factor = 0.2" 
		owner = SOV
		}
				}
				random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"227aya  Kavaleriyskaya Div.\" division_template = \"Kavaleriyskaya Diviziya\" start_experience_factor = 0.2" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"226aya  Kavaleriyskaya Div.\" division_template = \"Kavaleriyskaya Diviziya\" start_experience_factor = 0.2" 
		owner = SOV
		}
				}
			}
	}

}
country_event = {
	id = soviet.570
	title = soviet.570.t
	desc = soviet.570.d
	picture = GFX_report_event_soldiers_marching

	fire_only_once = yes
	
	trigger = {
		tag = SOV
		is_ai = yes
		has_war_with = GER
		NOT = { has_country_flag = stalingraddef }
		
		# german advance check
		or = {
		NOT = { SOV = { controls_state = 245 }}
		NOT = { SOV = { controls_state = 217 }}
		}
		
		OR = {
		has_country_flag = korps44
		has_country_flag = korps42
		has_country_flag = korps40
		}
		
		surrender_progress > 0.2
		SOV = { controls_state = 217 } # controls stalingrad 3529
		#controls = 3529
		
		#GER = {is_ai = no}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = soviet.570.a
		ai_chance = { factor = 100 }
		if = {
		    limit = {
		         
		    }
		    country_event = { id = usa.54 days = 1 }
		}
		set_country_flag = stalingraddef
		
		
		hidden_effect = {
			load_oob = "SOV_stalingrad_defence"
	    }
		
         hidden_effect = { 
		 if = {  limit = { has_country_flag = korps44 }
		random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"22dya Tankovaya Korpus\" division_template = \"Tank Korpus '1943'\" start_experience_factor = 0.4" 
		owner = SOV
		}
				create_unit = { 
				division = "name = \"23dya Tankovaya Korpus\" division_template = \"Tank Korpus '1943'\" start_experience_factor = 0.4" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"24dya Tankovaya Korpus\" division_template = \"Tank Korpus '1943'\" start_experience_factor = 0.4" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"25dya Tankovaya Korpus\" division_template = \"Tank Korpus '1943'\" start_experience_factor = 0.4" 
		owner = SOV
		}
				}
		}
		else_if = {  limit = { has_country_flag = korps42 }
		random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"22dya Tankovaya Korpus\" division_template = \"Tank Korpus '1941'\" start_experience_factor = 0.4" 
		owner = SOV
		}
				create_unit = { 
				division = "name = \"23dya Tankovaya Korpus\" division_template = \"Tank Korpus '1941'\" start_experience_factor = 0.4" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"24dya Tankovaya Korpus\" division_template = \"Tank Korpus '1941'\" start_experience_factor = 0.4" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"25dya Tankovaya Korpus\" division_template = \"Tank Korpus '1941'\" start_experience_factor = 0.4" 
		owner = SOV
		}
				}
		}
		else_if = {  limit = { has_country_flag = korps40 }
		random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				create_unit = { 
				division = "name = \"22dya Tankovaya Korpus\" division_template = \"Tank Korpus '1939'\" start_experience_factor = 0.4" 
		owner = SOV
		}
				create_unit = { 
				division = "name = \"23dya Tankovaya Korpus\" division_template = \"Tank Korpus '1939'\" start_experience_factor = 0.4" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"24dya Tankovaya Korpus\" division_template = \"Tank Korpus '1939'\" start_experience_factor = 0.4" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"25dya Tankovaya Korpus\" division_template = \"Tank Korpus '1939'\" start_experience_factor = 0.4" 
		owner = SOV
		}
				}
		}
        }
	}
}

###### Veren's SOV Events for Sov-Jap War ######

country_event = {
	id = soviet.60
	title = soviet.60.t
	desc = soviet.60.d
	picture = GFX_report_event_japanese_soldiers_hong_kong
	
	is_triggered_only = yes
	
	fire_only_once = yes 
	option = {
	ai_chance = {
		factor = 80
		}
		name = soviet.60.a
		JAP = { transfer_state = 408 }
		JAP = { transfer_state = 409 }
		JAP = { transfer_state = 560 }
		JAP = { transfer_state = 657 }
		JAP = { transfer_state = 561 }
		JAP = { transfer_state = 563 }
		JAP = { transfer_state = 564 }
		JAP = { transfer_state = 565 }
		JAP = { transfer_state = 566 }
		JAP = { transfer_state = 655 }
		JAP = { transfer_state = 574 }
		JAP = { transfer_state = 562 }
		JAP = { transfer_state = 644 }
		JAP = { transfer_state = 637 }
		JAP = { transfer_state = 575 }
		white_peace = JAP
		ITA = { add_opinion_modifier = { target = JAP modifier = very_large_decrease } }
		if = { limit = { MON = { is_subject_of = SOV }  }
		SOV = {	
		        end_puppet = MON
		}
		}
		if = { limit = { MON = { is_in_faction_with = SOV }  }
		JAP = { puppet = MON }
		}
		
		if = { limit = { TAN = { is_subject_of = SOV }  }
		SOV = {	
		        end_puppet = TAN
		}
		}
		if = { limit = { TAN = { is_in_faction_with = SOV }  }
		JAP = { puppet = TAN }
		}
		
		if = { limit = { SIK = { is_subject_of = SOV }  }
		SOV = {	
		        end_puppet = SIK
		}
		}
		if = { limit = { SIK = { is_in_faction_with = SOV }  }
		JAP = { puppet = SIK }
		}
		
		JAP = { country_event = { id = japan.24 }}
	}
	
	option = {
		name = soviet.60.b
		ai_chance = {
			factor = 20
			}
		JAP = { country_event = { id = japan.25 }}
	}
}
###### Imperator's Events For Lend Lease ######

#Persian Corridor Lend Lease
country_event = {
	id = soviet.63
	title = soviet.63.t
	desc = soviet.63.d
	picture = GFX_report_event_persian_corridor
	
	is_triggered_only = yes
	

	fire_only_once = yes 
	option = {
	ai_chance = {
		factor = 90
		}
		name = soviet.63.a
			229 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			232 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			237 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			217 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			265 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			260 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			257 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			419 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
				}
				}
			SOV = { add_opinion_modifier = { target = PER modifier = very_large_increase } }
			PER = { add_opinion_modifier = { target = SOV modifier = very_large_increase } }
				}
	
	option = {
	name = soviet.63.b
	ai_chance = {
		factor = 10
		}
	}
}
#Pacific Lend Lease
country_event = {
	id = soviet.64
	title = soviet.64.t
	desc = soviet.64.d
	picture = GFX_report_event_opening_pacific_route
	
	is_triggered_only = yes
	
	trigger = {
		tag = SOV
		408 = {is_owned_by = SOV} 
		has_war_with = GER
		date > 1941.06.01
		not = {has_war_with = JAP}
	}
	fire_only_once = yes 
	option = {
	ai_chance = {
		factor = 70
		}
		name = soviet.64.a
			957 = {
				add_building_construction = {
				type = bunker
				level = 1
				type = naval_base
				level = 1
				instant_build = yes
				}
				}
			408 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			409 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			657 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			561 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			563  ={
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			564 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			566 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			567 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			568 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			569 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			570 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			571 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			403 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			572 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			573 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			573 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			651 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			249 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			256 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			252 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}
			253 = {
				add_building_construction = {
				type = infrastructure
				level = 1
				}
				}				
				}

	
	option {
	name = soviet.64.b
	ai_chance = {
		factor = 30
		}
	}
}
		
# Romania Accepts Demands
country_event = {
	id = soviet.65
	title = soviet.65.t
	desc = soviet.65.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.65.a
		SOV = { 
			transfer_state = 79
		}
		hidden_effect = {
			#SOV = {
				news_event = { days = 1 id = news.3 }
			#}
		}
	}
}

# Romania Refuses Demands
country_event = {
	id = soviet.66
	title = soviet.66.t
	desc = soviet.66.d
	picture = GFX_report_event_soviet_tanks_snow
	
	is_triggered_only = yes
	
	option = {
		name = soviet.66.a
		create_wargoal = {
			type = take_state
			target = ROM
			generator = { 79 }
		}				
		hidden_effect = {
			#SOV = {
				news_event = { days = 1 id = news.4 }	

			#}
		}
	}
}

#Murmansk Lend Lease
country_event = {
	id = soviet.68
	title = soviet.68.t
	desc = soviet.68.d
	picture = GFX_report_event_opening_northern_ports1
	
	is_triggered_only = yes
	
	trigger = {
		tag = SOV
		213 = {is_owned_by = SOV}
		has_war_with = GER
		date > 1941.07.31
	}
		
	fire_only_once = yes 
	option = {
	ai_chance = {
		factor = 70
		}
		name = soviet.68.a
				3134  = {
				add_building_construction = {
					type = naval_base
					level = 3
					instant_build = yes
					}
				add_building_construction = {
					type = bunker
					level = 2
					instant_build = yes
					}
				add_building_construction = {
					type = coastal_bunker]
					level = 3
					instant_build = yes
				}
				}
				213  = { 
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 3
					}
				add_building_construction = {
					type = dockyard
					level = 1
					instant_build = yes
				}
				}
	}
	
	option {
	name = soviet.68.b
	ai_chance = {
		factor = 30
		}
	}
}
#Arkangelesk Lend Lease
country_event = {
	id = soviet.69
	title = soviet.69.t
	desc = soviet.69.d
	picture = GFX_report_event_opening_northern_ports2
	
	is_triggered_only = yes
	
	trigger = {
		tag = SOV
		214 = {is_owned_by = SOV} 
		has_war_with = GER
		date > 1941.12.12
	}
	fire_only_once = yes 
	option = {
	ai_chance = {
		factor = 70
		}
		name = soviet.69.a
				3338  = {
				add_building_construction = {
					type = naval_base
					level = 2
					instant_build = yes
					}
				add_building_construction = {
					type = bunker
					level = 1
					instant_build = yes
					}
				add_building_construction = {
					type = coastal_bunker
					level = 2
					instant_build = yes
				}
				}
				214  = { 
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 2
					}
					add_building_construction = {
					type = dockyard
					level = 1
					instant_build = yes
				}
				}
	}
	
	option {
	name = soviet.69.b
	ai_chance = {
		factor = 30
		}
	}
}


country_event = {
	id = soviet.67
	title = soviet.67.t
	desc = soviet.67.d
	picture = GFX_report_event_soviet_tanks_snow
	
	is_triggered_only = yes
	
	option = {
		name = soviet.67.a		

	}
}

# Soviet Ultimatum to England about Pakistan
country_event = {
	id = soviet.70
	title = soviet.70.t
	desc = soviet.70.d
	picture = GFX_report_event_stalin_01
	
	is_triggered_only = yes
	
	
	option = { # Accept demands
		name = soviet.70.a
		ai_chance = { 
		factor = 10
		}
		hidden_effect = {
		SOV = {
			country_event = { days = 3 id = soviet.71 }
		}
		}
			ROOT = { 
				white_peace = {
					tag = PAK
					message = SOV_ultimatum
				} 
			}
			every_country = {
			limit = { is_in_faction_with = ROOT }
			    white_peace = {
					tag = PAK
					message = SOV_ultimatum
				} 
			}
			effect_tooltip = {
			    PAK = { set_rule = { can_join_factions = yes } }
				SOV = { 
		    		set_autonomy = { target = PAK autonomy_state = autonomy_SSR } 
		         	add_to_faction = PAK
				}
			}
		
	}
	option = { # Refuse
		name = soviet.70.b
		ai_chance = { factor = 0 }
		SOV = {
			country_event = { days = 5 id = soviet.72 }
			effect_tooltip = {
				create_wargoal = {
					type = annex_everything
					target = ROOT
				}
			}
		}
	}
}

# ENG Accepts Demands
country_event = {
	id = soviet.71
	title = soviet.71.t
	desc = soviet.71.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.71.a
		PAK = { set_rule = { can_join_factions = yes } }
		set_autonomy = { target = PAK autonomy_state = autonomy_SSR } 
		
		add_to_faction = PAK
		hidden_effect = {
				news_event = { days = 1 id = news.5555 }
		}
	}
}

# ENG Refuses Demands
country_event = {
	id = soviet.72
	title = soviet.72.t
	desc = soviet.72.d
	picture = GFX_report_event_soviet_tanks_snow
	
	is_triggered_only = yes
	
	option = {
		name = soviet.72.a
		create_wargoal = {
					type = annex_everything
					target = PREV
				}				
		hidden_effect = {
				news_event = { days = 1 id = news.4444 }	
		}
	}
}

# befriend japan
country_event = {
	id = soviet.73
	title = soviet.73.t
	desc = soviet.73.d
	picture = GFX_report_event_japan_europe_pact
	
	is_triggered_only = yes
	
	option = {
		name = soviet.71.a
		SOV = {
			set_truce = { target = ROOT days = 760 }
        }		
        if = { limit = { NOT = { has_non_aggression_pact_with = SOV } }
		diplomatic_relation = {
			country = FROM
			relation = non_aggression_pact
			active = yes
		}
        }
        add_timed_idea = {
					idea = JAP_rear_is_safe
					days = 800
		}		
		FROM = { country_event = { id = soviet.712 days = 1 } }
		
	}
	option = {
	    trigger= {
		NOT = {
		has_game_rule = {
				rule = must_sinojap_treaty
				option = block

			}
			}
			}
		name = soviet.71.b
		FROM = { country_event = { id = soviet.713 days = 1 } }
	}
}

#Japan propose NAP to ROOT
country_event = {
	id = soviet.712
	title = soviet.712.t
	desc = soviet.712.desc
	picture = GFX_report_event_japan_europe_pact

	is_triggered_only = yes
	
	option = {
		name = soviet.712.a
		ai_chance = {
			base = 10
		}
		effect_tooltip = {
		set_truce = { target = JAP days = 760 }
			diplomatic_relation = {
				country = FROM
				relation = non_aggression_pact
				active = yes
			}
		}
		add_timed_idea = {
					idea = SOV_rear_is_safe
					days = 800
		}
		hidden_effect = {
				news_event = { days = 1 id = news.7777 }	
		}
	}
}

#Japan propose NAP to ROOT
country_event = {
	id = soviet.713
	title = soviet.713.t
	desc = soviet.713.desc
	picture = GFX_report_event_japan_europe_pact

	is_triggered_only = yes
	
	option = {
		name = soviet.713.a
		ai_chance = {
			base = 10
		}
	}
}

# Red army is unprepared
country_event = {
	id = soviet.74
	title = soviet.74.t
	desc = soviet.74.d
	picture = GFX_report_event_soviet_purge
	
	is_triggered_only = yes
	
	option = {
		name = soviet.74.a
		add_ideas = SOV_unprepared_red_army
	}
}

country_event = {
	id = soviet.75
	title = soviet.75.t
	desc = soviet.75.d
	picture = GFX_report_event_soviet_purge_speech
	
	is_triggered_only = yes
	
	option = {
		name = soviet.75.a
		add_opinion_modifier = { target = SOV modifier = embargo }
		add_stability = -0.02
		SOV = { country_event = soviet.76 }
		ai_chance = { 
		    factor = 10
	    	modifier = {
    	    	factor = 40
	        	is_historical_focus_on = yes 
	    	}
			modifier = {
    	    	factor = 0.1
	        	communism > 0.3
	    	}
			modifier = {
    	    	factor = 0
	        	has_government = communism
	    	}
		}
	}
	option = {
		name = soviet.75.b
		#shiiiiee..
		ai_chance = { 
		    factor = 3
		}
	}
}
#wazzup
country_event = {
	id = soviet.76
	title = soviet.76.t
	desc = soviet.76.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.76.a
		effect_tooltip = { SWE = { add_opinion_modifier = { target = SOV modifier = embargo } } }
	}
}

country_event = {
	id = soviet.77   # Romania wants to negotiate for peace after a coup
	title = soviet.77.t
	desc = soviet.77.d
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = {
		name = soviet.77.a
		ROM = {
	    	every_other_country = {
		    	limit = { has_war_with = ROM }
	    		white_peace = { 
						tag = ROM
					}
			}
			add_popularity = { ideology = communism popularity = 0.17 }
		}
		ROM = { country_event = romania.13 }
			
	}
	option = {
		name = soviet.77.b
		ai_chance = {
			factor = 0
		}
	}
}

# Batum

country_event = {
	id = soviet.200
	title = soviet.200.t
	desc = soviet.200.d
	picture = GFX_report_event_batumtalep

	is_triggered_only = yes
	
	option = { # Accept demands
		name = soviet.200.a
		ai_chance = { 
			factor = 5
			modifier = {
				factor = 5
				NOT = {
					OR = {
						is_puppet_of = TUR
						is_in_faction_with = TUR
					}
				}
				TUR = {
					surrender_progress > 0.09
				}
			}
			modifier = {
				factor = 0
				any_other_country = {
					has_war_with = TUR
				}
			}
			modifier = {
				factor = 0
				any_other_country = {
					NOT = {
						tag = TUR
					}
					SOV = {
						is_puppet_of = PREV
					}
					NOT = {
						is_in_faction_with = TUR
					}
				}
			}
		}
      effect_tooltip = {
         TUR = { 
			  # transfer_state = 813 TODO BATUMI 
		   }
      }
      hidden_effect = {
		TUR = {
			country_event = { days = 1 id = turkey.33 }
		}
      }
	}
	option = { # Refuse
		name = soviet.200.b		
		ai_chance = { 
			factor = 95
			modifier = {
				factor = 95
				NOT = { is_historical_focus_on = yes }
				NOT = {
					TUR = {
						surrender_progress > 0.09
					}
				}
				NOT = {
					any_other_country = {
						has_war_with = TUR
					}
				}
				NOT = {
					any_other_country = {
						NOT = {
							tag = TUR
						}
						SOV = {
							is_puppet_of = PREV
						}
						NOT = {
							is_in_faction_with = TUR
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					is_in_faction_with = TUR
					SOV = {
						is_puppet_of = TUR
					}
				}
			}
		}
		effect_tooltip = {
			TUR = {
				#create_wargoal = {
				#type = take_state_focus
				#target = SOV
				#generator = { 813 } TODO BATUMI 
				#}
			}
		}
		hidden_effect = {
			TUR = {
				country_event = { days = 1 id = turkey.34 }
			}
		}		
	}
}

country_event = {
	id = soviet.331
	title = soviet.331.t
	desc = soviet.331.d
	picture = GFX_report_event_t34
	
	is_triggered_only = yes
	
	option = {
		name = soviet.331.a
		
	}
}

country_event = {
	id = soviet.332
	title = soviet.332.t
	desc = soviet.332.d
	picture = GFX_report_event_yak7
	
	is_triggered_only = yes
	
	option = {
		name = soviet.332.a
		
	}
}

#create Polish peoples army
country_event = {
	id = soviet.336
	title = soviet.336.t
	desc = soviet.336.d
	picture = GFX_report_event_soviet_soldiers
	
	is_triggered_only = yes
	
	option = {
		trigger = {
		SOV = { controls_state = 219 }}
		name = soviet.336.a
		#load_oob = SOV_polish_army
	}
	option = {
		trigger = {
		NOT = {SOV = { controls_state = 29 }}}
		name = soviet.336.b
		
	}
}
#recruit polish proletariat_divisions
country_event = {
	id = soviet.338
	title = soviet.338.t
	desc = soviet.338.d
	picture = GFX_report_event_soldiers_marching
	
	is_triggered_only = yes
	
	option = {
		name = soviet.338.a
		#add_ideas = proletariats_fight
		#load_oob = SOV_proletariat_divisions
	}
}

country_event = {
	id = soviet.339
	title = soviet.339.t
	desc = soviet.339.d
	picture = GFX_report_event_norway_airbase_finnmark_banak
	
	is_triggered_only = yes
	
	option = {
		name = soviet.339.a
	}
}


######### Soviet tank immersion events########

country_event = {
	id = soviet.340
	title = soviet.340.t
	desc = soviet.340.d
	picture = GFX_report_event_t34_76
	
	is_triggered_only = yes
	
	option = {
		name = soviet.340.a
	}
}
country_event = {
	id = soviet.341
	title = soviet.341.t
	desc = soviet.341.d
	picture = GFX_report_event_34_85
	
	is_triggered_only = yes
	
	option = {
		name = soviet.341.a
	}
}
country_event = {
	id = soviet.342
	title = soviet.342.t
	desc = soviet.342.d
	picture = GFX_report_event_kv_tank
	
	is_triggered_only = yes
	
	option = {
		name = soviet.342.a
	}
}
# IS
country_event = {
	id = soviet.343
	title = soviet.343.t
	desc = soviet.343.d
	picture = GFX_report_event_IS_tank
	
	is_triggered_only = yes
	
	option = {
		name = soviet.343.a
	}
}
# SU-85
country_event = {
	id = soviet.344
	title = soviet.344.t
	desc = soviet.344.d
	picture = GFX_report_event_SU85_tank
	
	is_triggered_only = yes
	
	option = {
		name = soviet.344.a
	}
}
#############################
country_event = {
	id = soviet.388
	title = soviet.388.t
	desc = soviet.388.d
	picture = GFX_report_event_soviet_soldiers
	
	is_triggered_only = yes
	
	option = {
		trigger = {
		SOV = { controls_state = 219 }}
		name = soviet.388.a
		add_manpower = -250000
		load_oob = SOV_berlings_army
	}
	option = {
		trigger = {
		NOT = {SOV = { controls_state = 219 }}}
		name = soviet.388.b
		
	}
}

country_event = {
	id = soviet.389
	title = soviet.389.t
	desc = soviet.389.d
	picture = GFX_SOV_winter
	
	is_triggered_only = yes
	
	immediate = {
	
	division_template = {
	name = "Strelkovaya Diviziya "			# Rifle Division

	regiments = {
		infantry = { x = 0 y = 0 }
		infantry = { x = 0 y = 1 }
		infantry = { x = 0 y = 2 }
		
		infantry = { x = 1 y = 0 }
		infantry = { x = 1 y = 1 }
		infantry = { x = 1 y = 2 }
			
		infantry = { x = 2 y = 0 }
		infantry = { x = 2 y = 1 }
		infantry = { x = 2 y = 2 }

		artillery_brigade = { x = 3 y = 0 }		
		artillery_brigade = { x = 3 y = 1 }
		artillery_brigade = { x = 3 y = 2 }
		anti_tank_brigade = { x = 3 y = 3 }
		
	}
	support = {
		DIV_HQ = { x = 0 y = 0 } 
		recon_mot = { x = 0 y = 1 } 		
		engineer = { x = 0 y = 2 }
		field_hospital = { x = 1 y = 0 }
		maintenance_company = { x = 1 y = 1 }
		logistics_company = { x = 1 y = 2 }
	}
	
	priority = 2
}
division_template = {
	name = "Proletariat division"		
        is_locked = yes	
	
	regiments = {
		militia = { x = 0 y = 0 }
		militia = { x = 0 y = 1 }
		militia = { x = 0 y = 2 }
		militia = { x = 0 y = 3 }
		militia = { x = 1 y = 0 }
		militia = { x = 1 y = 1 }
		militia = { x = 1 y = 2 }
		militia = { x = 2 y = 0 }
		militia = { x = 2 y = 1 }
		militia = { x = 2 y = 2 }
		
	}
	support = {
		nkvd = { x = 0 y = 0 }
		recon_mot = { x = 0 y = 1 }
		engineer = { x = 1 y = 0 }
	}
	
	priority = 2
}

	if = {
				limit = {
					
					NOT = { has_tech = mechanised_infantry }
					OR = {
						has_tech = tech_bt_art_1
						has_tech = subtech_t_34_art_1
						has_tech = subtech_t_34_art_2
						has_tech = subtech_t_34_art_3
					}
				}
				load_oob = SOV_winteroffensetank3
			}
			else_if = {
				limit = {
					
					has_tech = mechanised_infantry 
					OR = {
						has_tech = tech_bt_art_1
						has_tech = subtech_t_34_art_1
						has_tech = subtech_t_34_art_2
						has_tech = subtech_t_34_art_3
					}
				}
				load_oob = SOV_winteroffensetank5
			}
			else_if = {
				limit = {
					
					NOT = { has_tech = mechanised_infantry }
					OR = {
						has_tech = subtech_light_soviet_tank_art_1
						has_tech = subtech_light_soviet_tank_art_2
						has_tech = subtech_light_soviet_tank_art_3
						has_tech = subtech_light_soviet_tank_art_4
					}
					has_tech = tech_t_28_a
				}
				load_oob = SOV_winteroffensetank4
			}
			else_if = {
				limit = {
					
					has_tech = mechanised_infantry 
					OR = {
						has_tech = subtech_light_soviet_tank_art_1
						has_tech = subtech_light_soviet_tank_art_2
						has_tech = subtech_light_soviet_tank_art_3
						has_tech = subtech_light_soviet_tank_art_4
					}
					has_tech = tech_t_28_a
				}
				load_oob = SOV_winteroffensetank6
			}
			else_if = {
				limit = {
					
					NOT = { has_tech = mechanised_infantry }
					OR = {
						has_tech = subtech_light_soviet_tank_art_1
						has_tech = subtech_light_soviet_tank_art_2
						has_tech = subtech_light_soviet_tank_art_3
						has_tech = subtech_light_soviet_tank_art_4
					}
					NOT = { has_tech = tech_t_28_a }
				}
				load_oob = SOV_winteroffensetank10
			}
			else_if = {
				limit = {
					
					has_tech = mechanised_infantry 
					OR = {
						has_tech = subtech_light_soviet_tank_art_1
						has_tech = subtech_light_soviet_tank_art_2
						has_tech = subtech_light_soviet_tank_art_3
						has_tech = subtech_light_soviet_tank_art_4
					}
					NOT = { has_tech = tech_t_28_a }
				}
				load_oob = SOV_winteroffensetank12
			}
			else_if = {
				limit = {
					has_tech = tech_t_28_a
				}
				load_oob = SOV_winteroffensetank1
			}
			else = {
				load_oob = SOV_winteroffensetank0
			}
	}
	
	option = {
		ai_chance = { 
			factor = 100
		} # this is the north one
		trigger = {
			SOV = { controls_state = 248 }
			or = {
				surrender_progress > 0.2
				AND = {
					casualties > 2500000 
					check_variable = {
						var = global.ostfront_year_4
						value = 12
						compare = less_than
					}
				}
			}
		}
		name = soviet.389.a
		hidden_effect = {
			load_oob = SOV_winteroffense
	
			random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				prioritize = { 248 }
				
				create_unit = { 
				division = "name = \"177aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"189aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		}
				
				random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				prioritize = { 248 }
				create_unit = { 
				division = "name = \"211aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"147aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		}
		
		random_owned_controlled_state = { limit = { NOT = { state = 516 } }
		prioritize = { 248 }
		create_unit = { 
				division = "name = \"123aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"163aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
			}
		}
	}
	
	option = {
		ai_chance = {
			factor = 1
		}
		trigger = { # south one
			SOV = { controls_state = 217 }
			or = {
				surrender_progress > 0.2
				AND = {
					casualties > 2500000 
					check_variable = {
						var = global.ostfront_year_4
						value = 12
						compare = less_than
					}
				}
			}
		}
		name = soviet.389.b
		hidden_effect = {
			load_oob = SOV_winteroffense
			
			
			random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				prioritize = { 217 }						
				
				create_unit = { 
				division = "name = \"177aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"189aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		}
				
				random_owned_controlled_state = { limit = { NOT = { state = 516 } }
				prioritize = { 217 }
				create_unit = { 
				division = "name = \"211aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"147aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		}
		
		random_owned_controlled_state = { limit = { NOT = { state = 516 } }
		prioritize = { 217 }
		create_unit = { 
				division = "name = \"123aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"163aya 'Moskva' Strelk. Div.\" division_template = \"Strelkovaya Diviziya \" start_experience_factor = 0.2" 
		owner = SOV
		}
		
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
		create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
				
				create_unit = { 
				division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
		owner = SOV
		}
			}
		}
	}
	option = {
		ai_chance = {
			factor = 1
		}
		trigger = { # main one
			NOT = {
		    	or = {
					surrender_progress > 0.2
					AND = {
						casualties > 2500000 
						check_variable = {
							var = global.ostfront_year_4
							value = 12
							compare = less_than
						}
					}
				}
			}
		}
		name = soviet.389.c
		hidden_effect = {
			load_oob = SOV_winteroffense
		}
	}
}
	
	country_event = {
		id = soviet.390
		title = soviet.390.t
		desc = soviet.390.d
		picture = GFX_SOV_countryside
	
		is_triggered_only = yes
	
		option = {
			name = soviet.390.a
			add_ideas = SOV_unemp
		}
	}
	
	country_event = {
		id = soviet.391
		title = soviet.391.t
		desc = soviet.391.d
		picture = GFX_SOV_surr
	
		is_triggered_only = yes
		
		fire_only_once = yes
	
		option = {
			name = soviet.391.a
			ai_chance = {
				factor = 100
				modifier = {
					factor = 0
					surrender_progress < 0.9
				}
			}
			GER = {
				country_event = {
					id = soviet.392
					days = 1
				}
			}
		}
		option = {
			name = soviet.391.b
			ai_chance = {
				factor = 0
				modifier = {
					add = 500
					surrender_progress < 0.9
				}
			}
			news_event = {
				id = soviet.393
				days = 1
			}
		}
	}
	
	country_event = {
		id = soviet.392
		title = soviet.392.t
		desc = soviet.392.d
		picture = GFX_SOV_surr
	
		is_triggered_only = yes
	
		option = {
			name = soviet.392.a
			hidden_effect = {
				# ideas for soviet
				SOV = {
					add_ideas = SOV_lost
				}
				
				news_event = {
					id = worldnews.24
					days = 1
				}
					
				# states getting independent
				
				UZB = {
					set_technology = {
						################# infantry ###############
						infantry_uniforms = 1
						infantry_weapons = 1
						infantry_weapons1 = 1
						hmg = 1
						mortars = 1
						semi_motorised_infantry = 2
						tech_Garrison = 1
						tech_Headquarters = 1
						################## support ##################
						tech_recon = 1
						subtech_recon_cav_1 = 1
						tech_engineers = 1
						tech_support = 1
						################## artillery ###############
						gw_artillery = 2
						#interwar_artillery = 2
						################## armor ##############
						generic_armor = 1
						tech_Gun_Carriers = 1
						################## aircraft ##############
						early_fighter = 1
						CAS0 = 1
						generic_fighter = 1
						generic_bomber = 1
						############### economy ############
						construction0 = 1
						basic_industry = 2
						defence_works0 = 1
						infra_works0 = 1
						concentrated_industry = 2
						tech_Garrison_2 = 1
					}
					transfer_state = 587
					transfer_state = 585
					transfer_state = 584
					transfer_state = 405
					transfer_state = 732
					transfer_state = 742
					set_politics = {
						ruling_party = fascism
					}
					set_popularities = {
						democratic = 2
						neutrality = 30
						fascism = 63
						communism = 5
					}
					set_stability = 0.3
					set_war_support = 0.7
					add_manpower = 100000
					army_experience = 27
				}
				
				MON = {
					if = {
						limit = {
							is_puppet_of = SOV
						}
						SOV = {
							end_puppet = MON
						}
					}
					leave_faction = yes
					set_popularities = {
						democratic = 5
						neutrality = 35
						fascism = 15
						communism = 45
					}
					add_ai_strategy = {
						type = ignore 
						id = "SOV"
						value = 100
					}
				}
				
				
				if = { ### Sinkiang added here due to new events JAP
					limit = {
						SIK = { is_subject_of = SOV }
					}
					set_autonomy = { target = SIK autonomy_state = autonomy_free }
					every_country = {
						limit = {
							has_war_with = SIK
							is_in_faction_with = GER
						}
						white_peace = SIK
					}
					SIK = {
						leave_faction = yes
						set_rule = {
							can_join_factions = no 
							can_create_factions = no
						}
						set_popularities = {
							democratic = 5
							neutrality = 30
							fascism = 35
							communism = 30
						}
						add_ai_strategy = {
							type = ignore 
							id = "SOV"
							value = 100
						}
					}
				}
				
				
				TAN = {
					set_technology = {
						################# infantry ###############
						infantry_uniforms = 1
						infantry_weapons = 1
						infantry_weapons1 = 1
						hmg = 1
						mortars = 1
						semi_motorised_infantry = 2
						tech_Garrison = 1
						tech_Headquarters = 1
						################## support ##################
						tech_recon = 1
						subtech_recon_cav_1 = 1
						tech_engineers = 1
						tech_support = 1
						################## artillery ###############
						gw_artillery = 2
						#interwar_artillery = 2
						################## armor ##############
						generic_armor = 1
						tech_Gun_Carriers = 1
						################## aircraft ##############
						early_fighter = 1
						CAS0 = 1
						generic_fighter = 1
						generic_bomber = 1
						############### economy ############
						construction0 = 1
						basic_industry = 2
						defence_works0 = 1
						infra_works0 = 1
						concentrated_industry = 2
						tech_Garrison_2 = 1
					}
					every_state = {
						limit = {
							OR = {
								state = 566
								state = 567
								state = 568
							}
						}
						TAN = {
							add_state_core = PREV
							transfer_state = PREV
						}
					}
					if = {
						limit = {
							is_puppet_of = SOV
						}
						SOV = {
							end_puppet = TAN
						}
						leave_faction = yes
					}
					set_politics = {
						ruling_party = neutrality
					}
					set_popularities = {
						democratic = 14
						neutrality = 60
						fascism = 20
						communism = 6
					}
					set_stability = 0.6
					set_war_support = 0.5
					add_manpower = 10000
					army_experience = 15
					load_oob = SOV_proletariat
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = TAN #Units for tag SIB faulty?
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = TAN #Units for tag SIB faulty?
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = TAN #Units for tag SIB faulty?
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = TAN #Units for tag SIB faulty?
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = TAN #Units for tag SIB faulty?
						}
					}
				}
				
				SIB = {
					add_timed_idea = {
						idea = SOV_anarchy
						days = 600
					}
					set_technology = {
						################# infantry ###############
						infantry_uniforms = 1
						infantry_weapons = 1
						infantry_weapons1 = 1
						hmg = 1
						mortars = 1
						semi_motorised_infantry = 2
						tech_Garrison = 1
						tech_Headquarters = 1
						################## support ##################
						tech_recon = 1
						subtech_recon_cav_1 = 1
						tech_engineers = 1
						tech_support = 1
						################## artillery ###############
						gw_artillery = 2
						#interwar_artillery = 2
						################## armor ##############
						generic_armor = 1
						tech_Gun_Carriers = 1
						################## aircraft ##############
						early_fighter = 1
						CAS0 = 1
						generic_fighter = 1
						generic_bomber = 1
						############### economy ############
						construction0 = 1
						basic_industry = 2
						defence_works0 = 1
						infra_works0 = 1
						concentrated_industry = 2
						tech_Garrison_2 = 1
					}
					transfer_state = 565
					transfer_state = 575
					transfer_state = 564
					transfer_state = 563
					transfer_state = 561
					transfer_state = 574
					transfer_state = 562
					transfer_state = 560
					transfer_state = 657
					transfer_state = 409
					transfer_state = 408
					transfer_state = 655
					transfer_state = 637
					transfer_state = 644
					transfer_state = 516
					transfer_state = 576
					set_politics = {
						ruling_party = neutrality
					}
					set_popularities = {
						democratic = 2
						neutrality = 78
						fascism = 15
						communism = 5
					}
					set_stability = 0.4
					set_war_support = 0.9
					add_manpower = 400000
					army_experience = 30
					
					load_oob = SOV_proletariat
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
					}
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
					}
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
					}
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
					}
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
					}
					random_owned_controlled_state = { limit = { NOT = { state = 516 } }
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
						create_unit = { 
							division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
							owner = SIB
						}
					}
				}
			
			if = {   #Greater Finland
				limit = { 
					FIN = { is_in_faction_with = GER }
				}
				FIN = {
					transfer_state = 216
					transfer_state = 215
					transfer_state = 213
				}
			}
			
			else = {
				GER = {
					transfer_state = 216
					transfer_state = 215
					transfer_state = 213
				}
			}
			
			if = {		#Lost territory in the Winter War
				limit = {
					146 = { is_owned_by = SOV }
					147 = { is_owned_by = SOV }
				}
				FIN = {
					transfer_state = 146
					transfer_state = 147
				}
			}
			
			if = {   #Bessarabia and Transnistria
				limit = {
					ROM = { is_in_faction_with = GER }
				}
				ROM = {
					transfer_state = 192
					transfer_state = 198
					transfer_state = 78
					transfer_state = 766
					transfer_state = 80
				}
			}
			
			else = {
				GER = {
					transfer_state = 192
					transfer_state = 198
					transfer_state = 78
					transfer_state = 766
					transfer_state = 80
				}
			}
			
			if = { 				#Baltic States
				limit = {
					189 = { is_owned_by = SOV }
					11 = { is_owned_by = SOV }
					12 = { is_owned_by = SOV }
					190 = { is_owned_by = SOV }
					191 = { is_owned_by = SOV }
					13 = { is_owned_by = SOV }
					784 = { is_owned_by = SOV }
				}
				GER = {
					transfer_state = 189
					transfer_state = 11
					transfer_state = 12
					transfer_state = 190
					transfer_state = 191
					transfer_state = 13
					transfer_state = 784
				}
				
			}
			
			if = {		#Eastern Poland
				limit = {
					96 = { is_owned_by = SOV }
					95 = { is_owned_by = SOV }
					97 = { is_owned_by = SOV }
					94 = { is_owned_by = SOV }
					93 = { is_owned_by = SOV }
					91 = { is_owned_by = SOV }
					89 = { is_owned_by = SOV }
				}
				GER = {
					transfer_state = 96
					transfer_state = 95
					transfer_state = 97
					transfer_state = 94
					transfer_state = 93
					transfer_state = 91
					transfer_state = 89
				}
			}
			
		    if = {		#Western SU
				limit = {
					OR = {
					208 = { is_owned_by = SOV }
					209 = { is_owned_by = SOV }
					195 = { is_owned_by = SOV }
					263 = { is_owned_by = SOV }
					210 = { is_owned_by = SOV }
					207 = { is_owned_by = SOV }
					242 = { is_owned_by = SOV }
					204 = { is_owned_by = SOV }
					206 = { is_owned_by = SOV }
					243 = { is_owned_by = SOV }
					241 = { is_owned_by = SOV }
					194 = { is_owned_by = SOV }
					193 = { is_owned_by = SOV }
					202 = { is_owned_by = SOV }
					201 = { is_owned_by = SOV }
					203 = { is_owned_by = SOV }
					199 = { is_owned_by = SOV }
					197 = { is_owned_by = SOV }
					226 = { is_owned_by = SOV }
					196 = { is_owned_by = SOV }
					200 = { is_owned_by = SOV }
					227 = { is_owned_by = SOV }
					221 = { is_owned_by = SOV }
					259 = { is_owned_by = SOV }
					225 = { is_owned_by = SOV }
					224 = { is_owned_by = SOV }
					205 = { is_owned_by = SOV }
					246 = { is_owned_by = SOV }
					264 = { is_owned_by = SOV }
					244 = { is_owned_by = SOV }
					247 = { is_owned_by = SOV }
					219 = { is_owned_by = SOV }
					223 = { is_owned_by = SOV }
					222 = { is_owned_by = SOV }
					220 = { is_owned_by = SOV }
					240 = { is_owned_by = SOV }
					228 = { is_owned_by = SOV }
					218 = { is_owned_by = SOV }
					238 = { is_owned_by = SOV }
					234 = { is_owned_by = SOV }
					245 = { is_owned_by = SOV }
					235 = { is_owned_by = SOV }
					233 = { is_owned_by = SOV }
					231 = { is_owned_by = SOV }
					#797 = { is_owned_by = SOV } 813 TODO BATUMI 
					232 = { is_owned_by = SOV }
					229 = { is_owned_by = SOV }
					230 = { is_owned_by = SOV }
					237 = { is_owned_by = SOV }
					236 = { is_owned_by = SOV }
					217 = { is_owned_by = SOV }
					265 = { is_owned_by = SOV }
					260 = { is_owned_by = SOV }
					239 = { is_owned_by = SOV }
					257 = { is_owned_by = SOV }
					254 = { is_owned_by = SOV }
					255 = { is_owned_by = SOV }
					252 = { is_owned_by = SOV }
					253 = { is_owned_by = SOV }
					248 = { is_owned_by = SOV }
					260 = { is_owned_by = SOV }
					351 = { is_owned_by = SOV }
					247 = { is_owned_by = SOV }
					256 = { is_owned_by = SOV }
					250 = { is_owned_by = SOV }
					258 = { is_owned_by = SOV }
					137 = { is_owned_by = SOV }
					401 = { is_owned_by = SOV }
					}
				}	
			every_state = {		#Western SU
				limit = {
				    OR = {
					state = 208  
					state = 209  
					state = 195  
					state = 263  
					state = 210  
					state = 207  
					state = 242  
					state = 204  
					state = 206  
					state = 243  
					state = 241  
					state = 194  
					state = 193  
					state = 202  
					state = 201  
					state = 203  
					state = 199  
					state = 197  
					state = 226  
					state = 196  
					state = 200  
					state = 227  
					state = 221  
					state = 259  
					state = 225  
					state = 224  
					state = 205  
					state = 246  
					state = 264  
					state = 244  
					state = 247  
					state = 219  
					state = 223  
					state = 222  
					state = 220  
					state = 240  
					state = 228  
					state = 218  
					state = 238  
					state = 234  
					state = 245  
					state = 235  
					state = 233  
					state = 231  
					#state = 797  813 TODO BATUMI 
					state = 232  
					state = 229  
					state = 230  
					state = 237  
					state = 236  
					state = 217  
					state = 265  
					state = 260  
					state = 239  
					state = 257  
					state = 254  
					state = 255  
					state = 252  
					state = 253  
					state = 248  
					state = 260  
					state = 351  
					state = 247  
					state = 256  
					state = 250  
					state = 258  
					state = 137  
					state = 401  
					}
					is_owned_by = SOV
				}
				GER = {
					transfer_state = PREV
				}
				}
				every_state = { #Operation Countenance/Iran stuff, returns stuff to Iran after Peace in the East TODO: maybe add a sanity check if Iran doesn't exist or is capitulated or something...
					limit = {
						is_core_of = PER
						is_owned_by = SOV
					}
					PER = {
						transfer_state = PREV
					}
				}
				every_country = {
					limit = { 
						has_war_with = SOV
						is_in_faction_with = GER
					}
					white_peace = { 
						tag = SOV
					}
					white_peace = {
						tag = MON
					}
					white_peace = {
						tag = TAN
					}
					set_truce = {
						target = SOV
						days = 900
					}
					set_truce = {
						target = MON
						days = 365
					}
					set_truce = {
						target = TAN
						days = 365
					}
				}
				
				#Checked but not many scenario's
				every_country = {
					limit = {
						is_in_faction_with = SOV
						surrender_progress < 0.05
					}
					leave_faction = yes
					every_country = {
						limit = { has_war_with = PREV }
						white_peace = PREV
					}
				}
				
				SIB = {
					declare_war_on = {
						target = SOV
						type = annex_everything
					}
				}

				GER = {
					activate_decision = GER_reorganize_the_east
				}				
				else = {
					GER = {
						annex_country = {
							target = SOV
							transfer_troops = no
						}
					}
				}
				
			}
		}
		
			news_event = {
				id = soviet.394
				days = 1
			}
			# if = {
				# limit = { has_global_flag = persia_accept }
				# ENG = {
					# country_event = {
						# id = soviet.396
						# days = 1
					# }
				# }
			# }
			set_global_flag = eastern_front_peace
		}
		
		option = {
			ai_chance = { factor = 0 }
			name = soviet.392.b
			news_event = {
				id = soviet.395
				days = 1
			}
		}
	}
	
news_event = {
    id = soviet.393
    title =	soviet.393.t
    desc = soviet.393.d
    picture = GFX_SOV_war2

    major = yes

    is_triggered_only = yes

    #German response
    option = {
        name = soviet.393.a
        trigger = {
            tag = GER
        }
    }

    #Global Response
    option = {
        name = soviet.393.b
        trigger = {
            NOT = {
                tag = SOV
				tag = GER
            }
        }
	}
	#soviet
	option = {
        name = soviet.393.c
        trigger = {
            original_tag = SOV
        }
	}
}

news_event = {
    id = soviet.394
    title =	soviet.394.t
    desc = soviet.394.d
    picture = GFX_news_event_german_inspect_troops

    major = yes

    is_triggered_only = yes

    #German response
    option = {
        name = soviet.394.a
        trigger = {
            tag = GER
        }
    }

    #Global Response
    option = {
        name = soviet.394.b
        trigger = {
            NOT = {
                tag = SOV
				tag = GER
            }
        }
	}
	#soviet
	option = {
        name = soviet.394.c
        trigger = {
            original_tag = SOV
        }
	}
}

news_event = {
    id = soviet.395
    title =	soviet.395.t
    desc = soviet.395.d
    picture = GFX_GER_war

    major = yes

    is_triggered_only = yes

    #German response
    option = {
        name = soviet.395.a
        trigger = {
            tag = GER
        }
    }

    #Global Response
    option = {
        name = soviet.395.b
        trigger = {
            NOT = {
                tag = SOV
				tag = GER
            }
        }
	}
	#soviet
	option = {
        name = soviet.395.c
        trigger = {
            original_tag = SOV
        }
	}
}

# country_event = { #Doesn't really make sense UK could grab these isolated territories tbh
		# id = soviet.396
		# title = soviet.396.t
		# desc = soviet.396.d
		# picture = GFX_ENG_iran
	
		# is_triggered_only = yes
	
		# option = {
			# name = soviet.396.a
			# every_state = { limit = { is_core_of = PER is_controlled_by = SOV } 
			# PER =  { transfer_state = PREV }
			# }
		# }
		# option = {
			# name = soviet.396.b
			# every_state = { limit = { is_core_of = PER is_controlled_by = SOV } 
			# ENG =  { transfer_state = PREV }
			# add_resistance = 35
			# set_compliance = 10
			# }
			
		# }
	# }
	
country_event = {
	id = soviet.397
	title = soviet.397.t
	desc = soviet.397.d
	picture = GFX_report_event_soviet_purge_officers_01
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.397.a
		hidden_effect = { retire_character = yakov_smushkevich }
		hidden_effect = { retire_character = pavel_rychagov }
		
		custom_effect_tooltip = remove_chief_of_airforce
		show_ideas_tooltip = yakov_smushkevich
		show_ideas_tooltip = pavel_rychagov
		
		custom_effect_tooltip = soviet.27_tt
		hidden_effect = {
			set_country_flag = purge_air
		}
		add_ideas = air_purged
	}
	
	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.397.b
		hidden_effect = { retire_character = andrei_belov }
		hidden_effect = { retire_character = konstantin_vershinin }
		
		custom_effect_tooltip = remove_chief_of_airforce
		show_ideas_tooltip = andrei_belov
		show_ideas_tooltip = konstantin_vershinin
		
		custom_effect_tooltip = soviet.27_tt
		hidden_effect = {
			set_country_flag = purge_air
		}
		if = {
			limit = {
				NOT = { has_country_flag = purge_1_group_b }
			}
			add_ideas = air_purged
		}
	}
}

country_event = {
	id = soviet.398
	title = soviet.398.t
	desc = soviet.398.d
	picture = GFX_report_event_opening_northern_ports2
	
	is_triggered_only = yes
	
	trigger = {
		tag = DON
		or = {
			229 = { is_controlled_by = USA }
			229 = { is_controlled_by = PER }
			229 = { is_controlled_by = ENG }
			229 = { is_controlled_by = FRA }
		}
		has_global_flag = eastern_front_peace
	}
	fire_only_once = yes 
	option = {
		ai_chance = {
			factor = 100
		}
		name = soviet.398.a
		236 = {
			CONTROLLER = {
				ROOT = {
					declare_war_on = {
						target = PREV
						type = annex_everything
					}						
				}	
			}				
		}
		hidden_effect = {
			news_event = {
				id = worldnews.27
				days = 1
			}
		}
	}
}

country_event = {
	id = soviet.587
	title = soviet.587.t
	desc = soviet.587.d
	picture = GFX_report_event_SOV_oil
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.587.a
		add_resource = {
			type = oil
			amount = 38
			state =	398
		}
		add_political_power = 10
	}
}
	

country_event = {
	id = soviet.428
	title = soviet.428.t
	desc = soviet.428.d
	picture = GFX_report_event_SOV_officers
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.428.a
		SOV_officer_purge_decrease = yes
	}
}

country_event = {
	id = soviet.429
	title = soviet.429.t
	desc = soviet.429.d
	picture = GFX_report_event_SOV_manchuria
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.429.a
		custom_effect_tooltip = remove_general_vasily
		hidden_effect = { 
			retire_character = SOV_vasily_blyukher 
			country_event = { id = soviet.430 days = 365 }
		}
	}
	option = {
		ai_chance = {
			factor = 0
		}
		name = soviet.429.b
		add_stability = -0.1
		hidden_effect = { country_event = { id = soviet.430 days = 365 } }
	}
}

country_event = {
	id = soviet.430
	title = soviet.430.t
	desc = soviet.430.d
	picture = GFX_report_event_SOV_bloodydwarf
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 50
		}
		name = soviet.430.a
		custom_effect_tooltip = remove_political_advisor
		show_ideas_tooltip = SOV_nikolai_yezhov
		hidden_effect = { retire_character = SOV_nikolai_yezhov }
	}
	option = {
		ai_chance = {
			factor = 0
		}
		name = soviet.430.b
		add_stability = -0.1
	}
}
